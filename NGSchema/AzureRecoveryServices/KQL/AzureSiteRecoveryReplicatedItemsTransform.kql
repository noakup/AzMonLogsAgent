source
| extend primaryFabricType = tostring(properties.primaryFabricType)
| project
    TimeGenerated = todatetime(['time']),
    Category = category,
    VaultName = tostring(split(resourceId, '/')[8]),
    VaultType = strcat(tostring(split(resourceId, '/')[6]), "/", tostring(split(resourceId, '/')[7])),
    OperationName = operationName,
    ReplicationHealthErrors = tostring(properties.replicationHealthErrors),
    RecoveryRegion = tostring(properties.recoveryRegion),
    MultiVMGroupId = tostring(properties.multiVmGroupId),
    LastSuccessfulTestFailoverTime = todatetime(properties.lastSuccessfulTestFailoverTime),
    LastHeartbeat = todatetime(properties.lastHeartbeat),
    ReplicationStatus = tostring(properties.replicationHealth),
    FailoverReadiness = tostring(properties.failoverHealth),
    DatasourceFriendlyName = tostring(properties.replicatedItemFriendlyName),
    DatasourceUniqueId = tostring(properties.id),
    PrimaryFabricName = tostring(properties.primaryFabricName),
    RecoveryFabricName = tostring(properties.recoveryFabricName),
    PrimaryFabricType = primaryFabricType,
    RecoveryFabricType = tostring(properties.recoveryFabricType),
    ProtectionInfo = tostring(properties.protectionState),
    ActiveLocation = tostring(properties.activeLocation),
    PolicyFriendlyName = tostring(properties.policyName),
    OSFamily = tostring(properties.osFamily),
    IRProgressPercentage = toint(properties.initialReplicationProgressPercentage),
    DatasourceType = iff(primaryFabricType == "Azure", "Microsoft.Compute/virtualMachines", primaryFabricType),
    LastRpoCalculatedTime = todatetime(properties.lastRpoCalculatedTime),
    Version = "V2",
    ReplicatedItemId = tostring(properties.replicatedItemId),
    ReplicatedItemUniqueId = tostring(properties.replicatedItemUniqueId),
    SourceResourceId = tostring(properties.datasourceResourceId),
    PolicyUniqueId = tostring(properties.policyUniqueId),
    PolicyId = tostring(properties.policyArmId),
    ReplicatedItemFriendlyName = tostring(properties.replicatedItemFriendlyName),
    VaultLocation = tostring(properties.vaultLocation)