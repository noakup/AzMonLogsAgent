let DisabledParsers=materialize(_GetWatchlist('ASimDisabledParsers') 
| where SearchKey in ('Any', 'Exclude_Im_WebSession') 
| extend SourceSpecificParser=column_ifexists('SourceSpecificParser','') 
| where isnotempty(SourceSpecificParser) 
| summarize list = make_set(SourceSpecificParser));
let builtInDisabled = 0 != array_length(set_intersect(toscalar(DisabledParsers),dynamic(['Exclude_Im_WebSessionBuiltIn', 'Exclude_Im_WebSession', 'Any'])));
union isfuzzy=true
_Im_WebSession_ApacheHTTPServerV01(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_ApacheHTTPServer' in (DisabledParsers)))),
_Im_WebSession_BarracudaWAFV01(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_BarracudaWAF' in (DisabledParsers)))),
_Im_WebSession_CiscoFirepowerV01(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_CiscoFirepower' in (DisabledParsers)))),
_Im_WebSession_CiscoMerakiV01(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_CiscoMeraki' in (DisabledParsers)))),
_Im_WebSession_F5ASMV01(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_F5ASM' in (DisabledParsers)))),
_Im_WebSession_FortinetFortiGateV01(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_FortinetFortiGate' in (DisabledParsers)))),
_Im_WebSession_IISV01(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_IIS' in (DisabledParsers)))),
_Im_WebSession_NativeV01(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_Native' in (DisabledParsers)))),
_Im_WebSession_PaloAltoCEFV02(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_PaloAltoCEF' in (DisabledParsers)))),
_Im_WebSession_SquidProxyV06(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_SquidProxy' in (DisabledParsers)))),
_Im_WebSession_VectraAIV02(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_VectraAI' in (DisabledParsers))), pack= pack),
_Im_WebSession_ZscalerZIAV06(starttime= starttime, endtime= endtime, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, ipaddr_has_any_prefix= ipaddr_has_any_prefix, url_has_any= url_has_any, httpuseragent_has_any= httpuseragent_has_any, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_WebSession_ZscalerZIA' in (DisabledParsers))))
