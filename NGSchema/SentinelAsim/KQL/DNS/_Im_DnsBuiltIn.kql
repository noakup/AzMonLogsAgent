let DisabledParsers=materialize(_GetWatchlist('ASimDisabledParsers') 
| where SearchKey in ('Any', 'Exclude_Im_Dns') 
| extend SourceSpecificParser=column_ifexists('SourceSpecificParser','') 
| where isnotempty(SourceSpecificParser) 
| summarize list = make_set(SourceSpecificParser));
let builtInDisabled = 0 != array_length(set_intersect(toscalar(DisabledParsers),dynamic(['Exclude_Im_DnsBuiltIn', 'Exclude_Im_Dns', 'Any'])));
union isfuzzy=true
_Im_Dns_AzureFirewallV03(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_AzureFirewall' in (DisabledParsers)))),
_Im_Dns_CiscoUmbrellaV03(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_CiscoUmbrella' in (DisabledParsers)))),
_Im_Dns_CorelightZeekV05(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_CorelightZeek' in (DisabledParsers)))),
_Im_Dns_EmptyV04,
_Im_Dns_FortinetFortiGateV01(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_FortinetFortiGate' in (DisabledParsers)))),
_Im_Dns_GcpV04(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_Gcp' in (DisabledParsers)))),
_Im_Dns_InfobloxNIOSV05(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_InfobloxNIOS' in (DisabledParsers)))),
_Im_Dns_MicrosoftNXlogV05(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_MicrosoftNXlog' in (DisabledParsers)))),
_Im_Dns_MicrosoftOMSV04(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_MicrosoftOMS' in (DisabledParsers)))),
_Im_Dns_MicrosoftSysmonV04(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_MicrosoftSysmon' in (DisabledParsers)))),
_Im_Dns_NativeV06(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_Native' in (DisabledParsers)))),
_Im_Dns_VectraAIV01(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_VectraAI' in (DisabledParsers)))),
_Im_Dns_ZscalerZIAV04(starttime= starttime, endtime= endtime, srcipaddr= srcipaddr, domain_has_any= domain_has_any, responsecodename= responsecodename, response_has_ipv4= response_has_ipv4, response_has_any_prefix= response_has_any_prefix, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_Dns_ZscalerZIA' in (DisabledParsers))))
