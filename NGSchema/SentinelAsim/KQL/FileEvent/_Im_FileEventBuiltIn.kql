let DisabledParsers=materialize(_GetWatchlist('ASimDisabledParsers') 
| where SearchKey in ('Any', 'Exclude_Im_FileEvent') 
| extend SourceSpecificParser=column_ifexists('SourceSpecificParser','') 
| where isnotempty(SourceSpecificParser) 
| summarize list = make_set(SourceSpecificParser));
let builtInDisabled = 0 != array_length(set_intersect(toscalar(DisabledParsers),dynamic(['Exclude_Im_FileEventBuiltIn', 'Exclude_Im_FileEvent', 'Any'])));
union isfuzzy=true
_Im_FileEvent_AzureBlobStorageV01(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_AzureBlobStorage' in (DisabledParsers)))),
_Im_FileEvent_AzureFileStorageV01(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_AzureFileStorage' in (DisabledParsers)))),
_Im_FileEvent_AzureQueueStorageV01(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_AzureQueueStorage' in (DisabledParsers)))),
_Im_FileEvent_AzureTableStorageV01(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_AzureTableStorage' in (DisabledParsers)))),
_Im_FileEvent_EmptyV01,
_Im_FileEvent_GoogleWorkspaceV01(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_GoogleWorkspace' in (DisabledParsers)))),
_Im_FileEvent_LinuxSysmonFileCreatedV02(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_LinuxSysmonFileCreated' in (DisabledParsers)))),
_Im_FileEvent_LinuxSysmonFileDeletedV02(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_LinuxSysmonFileDeleted' in (DisabledParsers)))),
_Im_FileEvent_Microsoft365DV02(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_Microsoft365D' in (DisabledParsers)))),
_Im_FileEvent_MicrosoftSharePointV03(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_MicrosoftSharePoint' in (DisabledParsers)))),
_Im_FileEvent_MicrosoftSysmonV04(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_MicrosoftSysmon' in (DisabledParsers)))),
_Im_FileEvent_MicrosoftWindowsEventsV01(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_MicrosoftWindowsEvents' in (DisabledParsers)))),
_Im_FileEvent_NativeV01(starttime= starttime, endtime= endtime, eventtype_in= eventtype_in, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, actorusername_has_any= actorusername_has_any, targetfilepath_has_any= targetfilepath_has_any, srcfilepath_has_any= srcfilepath_has_any, hashes_has_any= hashes_has_any, dvchostname_has_any= dvchostname_has_any, disabled= (builtInDisabled or('Exclude_Im_FileEvent_Native' in (DisabledParsers))))
