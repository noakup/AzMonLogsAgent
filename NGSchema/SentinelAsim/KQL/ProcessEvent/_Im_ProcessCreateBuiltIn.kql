let DisabledParsers=materialize(_GetWatchlist('ASimDisabledParsers') 
| where SearchKey in ('Any', 'Exclude_Im_ProcessCreate') 
| extend SourceSpecificParser=column_ifexists('SourceSpecificParser','') 
| where isnotempty(SourceSpecificParser) 
| summarize list = make_set(SourceSpecificParser));
let builtInDisabled = 0 != array_length(set_intersect(toscalar(DisabledParsers),dynamic(['Exclude_Im_ProcessCreateBuiltIn', 'Exclude_Im_ProcessCreate', 'Any'])));
union isfuzzy=true
_Im_ProcessCreate_LinuxSysmonV03(starttime= starttime, endtime= endtime, commandline_has_any= commandline_has_any, commandline_has_all= commandline_has_all, commandline_has_any_ip_prefix= commandline_has_any_ip_prefix, actingprocess_has_any= actingprocess_has_any, targetprocess_has_any= targetprocess_has_any, parentprocess_has_any= parentprocess_has_any, targetusername= targetusername, dvcipaddr_has_any_prefix= dvcipaddr_has_any_prefix, dvcname_has_any= dvcname_has_any, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_ProcessCreate_LinuxSysmon' in (DisabledParsers)))),
_Im_ProcessCreate_MD4IoTV01(starttime= starttime, endtime= endtime, commandline_has_any= commandline_has_any, commandline_has_all= commandline_has_all, commandline_has_any_ip_prefix= commandline_has_any_ip_prefix, actingprocess_has_any= actingprocess_has_any, targetprocess_has_any= targetprocess_has_any, parentprocess_has_any= parentprocess_has_any, targetusername= targetusername, dvcipaddr_has_any_prefix= dvcipaddr_has_any_prefix, dvcname_has_any= dvcname_has_any, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_ProcessCreate_MD4IoT' in (DisabledParsers)))),
_Im_ProcessCreate_MicrosoftSecurityEventsV02(starttime= starttime, endtime= endtime, commandline_has_any= commandline_has_any, commandline_has_all= commandline_has_all, commandline_has_any_ip_prefix= commandline_has_any_ip_prefix, actingprocess_has_any= actingprocess_has_any, targetprocess_has_any= targetprocess_has_any, parentprocess_has_any= parentprocess_has_any, targetusername_has= targetusername, dvcipaddr_has_any_prefix= dvcipaddr_has_any_prefix, dvchostname_has_any= dvcname_has_any, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_ProcessCreate_MicrosoftSecurityEvents' in (DisabledParsers)))),
_Im_ProcessCreate_MicrosoftSysmonV04(starttime= starttime, endtime= endtime, commandline_has_any= commandline_has_any, commandline_has_all= commandline_has_all, commandline_has_any_ip_prefix= commandline_has_any_ip_prefix, actingprocess_has_any= actingprocess_has_any, targetprocess_has_any= targetprocess_has_any, parentprocess_has_any= parentprocess_has_any, targetusername_has= targetusername, dvcipaddr_has_any_prefix= dvcipaddr_has_any_prefix, dvchostname_has_any= dvcname_has_any, eventtype= eventtype, disabled= (builtInDisabled or('Exclude_Im_ProcessCreate_MicrosoftSysmon' in (DisabledParsers)))),
_Im_ProcessCreate_MicrosoftWindowsEventsV03(starttime= starttime, endtime= endtime, commandline_has_any= commandline_has_any, commandline_has_all= commandline_has_all, commandline_has_any_ip_prefix= commandline_has_any_ip_prefix, actingprocess_has_any= actingprocess_has_any, targetprocess_has_any= targetprocess_has_any, parentprocess_has_any= parentprocess_has_any, targetusername_has= targetusername, dvcipaddr_has_any_prefix= dvcipaddr_has_any_prefix, dvchostname_has_any= dvcname_has_any, eventtype= eventtype, hashes_has_any= hashes_has_any, disabled= (builtInDisabled or('Exclude_Im_ProcessCreate_MicrosoftWindowsEvents' in (DisabledParsers)))),
_Im_Process_EmptyV01,
_Im_ProcessEvent_Microsoft365DV02(starttime= starttime, endtime= endtime, commandline_has_any= commandline_has_any, commandline_has_all= commandline_has_all, commandline_has_any_ip_prefix= commandline_has_any_ip_prefix, actingprocess_has_any= actingprocess_has_any, targetprocess_has_any= targetprocess_has_any, parentprocess_has_any= parentprocess_has_any, targetusername_has= targetusername, dvcipaddr_has_any_prefix= dvcipaddr_has_any_prefix, dvchostname_has_any= dvcname_has_any, eventtype= eventtype, hashes_has_any= hashes_has_any, disabled= (builtInDisabled or('Exclude_Im_ProcessEvent_Microsoft365D' in (DisabledParsers)))),
_Im_ProcessEvent_NativeV01(starttime= starttime, endtime= endtime, commandline_has_any= commandline_has_any, commandline_has_all= commandline_has_all, commandline_has_any_ip_prefix= commandline_has_any_ip_prefix, actingprocess_has_any= actingprocess_has_any, targetprocess_has_any= targetprocess_has_any, parentprocess_has_any= parentprocess_has_any, targetusername_has= targetusername, dvcipaddr_has_any_prefix= dvcipaddr_has_any_prefix, dvchostname_has_any= dvcname_has_any, eventtype= eventtype, hashes_has_any= hashes_has_any, disabled= (builtInDisabled or('Exclude_Im_ProcessEvent_Native' in (DisabledParsers))))
