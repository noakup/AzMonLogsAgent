let DisabledParsers=materialize(_GetWatchlist('ASimDisabledParsers') 
| where SearchKey in ('Any', 'Exclude_Im_Authentication') 
| extend SourceSpecificParser=column_ifexists('SourceSpecificParser','') 
| where isnotempty(SourceSpecificParser) 
| summarize list = make_set(SourceSpecificParser));
let builtInDisabled = 0 != array_length(set_intersect(toscalar(DisabledParsers),dynamic(['Exclude_Im_AuthenticationBuiltIn', 'Exclude_Im_Authentication', 'Any'])));
union isfuzzy=true
_Im_Authentication_AADManagedIdentitySignInLogsV02(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_AADManagedIdentitySignInLogs' in (DisabledParsers)))),
_Im_Authentication_AADNonInteractiveUserSignInLogsV02(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_AADNonInteractiveUserSignInLogs' in (DisabledParsers)))),
_Im_Authentication_AADServicePrincipalSignInLogsV02(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_AADServicePrincipalSignInLogs' in (DisabledParsers)))),
_Im_Authentication_SigninLogsV03(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_SigninLogs' in (DisabledParsers)))),
_Im_Authentication_AWSCloudTrailV02(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_AWSCloudTrail' in (DisabledParsers)))),
_Im_Authentication_BarracudaWAFV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_BarracudaWAF' in (DisabledParsers)))),
_Im_Authentication_CiscoASAV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_CiscoASA' in (DisabledParsers)))),
_Im_Authentication_CiscoISEV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_CiscoISE' in (DisabledParsers)))),
_Im_Authentication_CiscoMerakiV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_CiscoMeraki' in (DisabledParsers)))),
_Im_Authentication_EmptyV01,
_Im_Authentication_GoogleWorkspaceV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_GoogleWorkspace' in (DisabledParsers)))),
_Im_Authentication_IllumioSaaSCoreV03(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_IllumioSaaSCore' in (DisabledParsers)))),
_Im_Authentication_M365DefenderV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_M365Defender' in (DisabledParsers)))),
_Im_Authentication_MD4IoTV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_MD4IoT' in (DisabledParsers)))),
_Im_Authentication_MicrosoftWindowsEventV03(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_MicrosoftWindowsEvent' in (DisabledParsers)))),
_Im_Authentication_NativeV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_Native' in (DisabledParsers)))),
_Im_Authentication_OktaSSOV02(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_OktaSSO' in (DisabledParsers)))),
_Im_Authentication_PostgreSQLV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_PostgreSQL' in (DisabledParsers)))),
_Im_Authentication_SalesforceSCV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_SalesforceSC' in (DisabledParsers)))),
_Im_Authentication_SshdV02(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_Sshd' in (DisabledParsers)))),
_Im_Authentication_SuV02(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_Su' in (DisabledParsers)))),
_Im_Authentication_SudoV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_Sudo' in (DisabledParsers)))),
_Im_Authentication_VectraXDRAuditV01(starttime= starttime, endtime= endtime, username_has_any= username_has_any, targetappname_has_any= targetappname_has_any, srcipaddr_has_any_prefix= srcipaddr_has_any_prefix, srchostname_has_any= srchostname_has_any, eventtype_in= eventtype_in, eventresultdetails_in= eventresultdetails_in, eventresult= eventresult, disabled= (builtInDisabled or('Exclude_Im_Authentication_VectraXDRAudit' in (DisabledParsers))))