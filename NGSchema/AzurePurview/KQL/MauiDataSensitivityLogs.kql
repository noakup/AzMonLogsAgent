source
| extend propertybag = parse_json(tostring(Properties))
| project
    TimeGenerated = todatetime(["Time"]),
    PurviewTenantId = tostring(propertybag.PurviewTenantId),
    PurviewAccountName = tostring(propertybag.PurviewAccountName),
    PurviewRegion = tostring(propertybag.PurviewRegion),
    SourceName = tostring(propertybag.SourceName),
    SourceType = tostring(propertybag.SourceType),
    SourcePath = tostring(propertybag.SourcePath),
    SourceSubscriptionId = tostring(propertybag.SourceSubscriptionId),
    SourceRegion = tostring(propertybag.SourceRegion),
    SourceCollectionName = tostring(propertybag.SourceCollectionName),
    SourceScanId = tostring(propertybag.SourceScanId),
    AssetName = tostring(propertybag.AssetName),
    AssetPath = tostring(propertybag.AssetPath),
    AssetType = tostring(propertybag.AssetType),
    AssetCreationTime = todatetime(propertybag.AssetCreationTime),
    AssetModifiedTime = todatetime(propertybag.AssetModifiedTime),
    AssetLastScanTime = todatetime(propertybag.AssetLastScanTime),
    FileExtension = tostring(propertybag.FileExtension),
    FileSize = tolong(propertybag.FileSize),
    ActivityType = tostring(propertybag.ActivityType),
    ClassificationTrigger = tostring(propertybag.ClassificationTrigger),
    Classification = todynamic(propertybag.Classification), 
    ClassificationDetails = todynamic(propertybag.ClassificationDetails),
    SensitivityLabelTrigger = tostring(propertybag.SensitivityLabelTrigger),
    SensitivityLabel = todynamic(propertybag.SensitivityLabel),
    SensitivityLabelDetails = todynamic(propertybag.SensitivityLabelDetails)
