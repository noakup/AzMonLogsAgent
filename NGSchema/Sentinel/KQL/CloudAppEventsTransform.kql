source
| extend
propertiesTable = parse_json(properties)
| project
AccountId = tostring(propertiesTable["AccountId"]),
AccountType = tostring(propertiesTable["AccountType"]),
AdditionalFields = todynamic(propertiesTable["AdditionalFields"]),
AppInstanceId = toint(propertiesTable["AppInstanceId"]),
RawEventData = todynamic(propertiesTable["RawEventData"]),
ReportId = tostring(propertiesTable["ReportId"]),
ObjectId = tostring(propertiesTable["ObjectId"]),
ObjectType = tostring(propertiesTable["ObjectType"]),
ObjectName = tostring(propertiesTable["ObjectName"]),
ActivityObjects = todynamic(propertiesTable["ActivityObjects"]),
ActivityType = tostring(propertiesTable["ActivityType"]),
UserAgent = tostring(propertiesTable["UserAgent"]),
ISP = tostring(propertiesTable["ISP"]),
City = tostring(propertiesTable["City"]),
CountryCode = tostring(propertiesTable["CountryCode"]),
IsAnonymousProxy = tobool(propertiesTable["IsAnonymousProxy"]),
IsExternalUser = tobool(propertiesTable["IsExternalUser"]),
IsImpersonated = tobool(propertiesTable["IsImpersonated"]),
IPTags = todynamic(propertiesTable["IPTags"]),
IPAddress = tostring(propertiesTable["IPAddress"]),
IPCategory = tostring(propertiesTable["IPCategory"]),
OSPlatform = tostring(propertiesTable["OSPlatform"]),
DeviceType = tostring(propertiesTable["DeviceType"]),
IsAdminOperation = tobool(propertiesTable["IsAdminOperation"]),
AccountDisplayName = tostring(propertiesTable["AccountDisplayName"]),
AccountObjectId = tostring(propertiesTable["AccountObjectId"]),
ApplicationId = toint(propertiesTable["ApplicationId"]),
Application = tostring(propertiesTable["Application"]),
ActionType = tostring(propertiesTable["ActionType"]),
UserAgentTags = todynamic(propertiesTable["UserAgentTags"]),
TimeGenerated = todatetime(propertiesTable["Timestamp"]),
Timestamp = todatetime(propertiesTable["Timestamp"]),
AuditSource = tostring(propertiesTable["AuditSource"]),
LastSeenForUser = todynamic(propertiesTable["LastSeenForUser"]),
OAuthAppId = tostring(propertiesTable["OAuthAppId"]),
SessionData = todynamic(propertiesTable["SessionData"]),
UncommonForUser = todynamic(propertiesTable["UncommonForUser"])