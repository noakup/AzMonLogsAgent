source 
| extend ProtoPayload = parse_json(protoPayload) 
| extend Resource = parse_json(resource) 
| extend Operation = parse_json(operation) 
| extend TimeGenerated = timestamp, InsertID = insertId, LogName = logName, ReceiveTimestamp = receiveTimestamp, Severity = severity, Timestamp = timestamp, PayloadType = tostring(ProtoPayload['@type']), MethodName = tostring(ProtoPayload['methodName']), GCPResourceName = tostring(ProtoPayload['resourceName']), ServiceName = tostring(ProtoPayload['serviceName']), NumResponseItems = tostring(ProtoPayload['numResponseItems']), AuthenticationInfoPrincipalEmail = tostring(ProtoPayload['authenticationInfo']['principalEmail']), AuthenticationInfoPrincipalSubject = tostring(ProtoPayload['authenticationInfo']['principalSubject']), AuthenticationInfoServiceAccountKeyName = tostring(ProtoPayload['authenticationInfo']['serviceAccountKeyName']), AuthorizationInfo = tostring(ProtoPayload['authorizationInfo']), Status = tostring(ProtoPayload['status']), MetadataType = tostring(ProtoPayload['metadata']['@type']), MetadataParentDeltaDestinationParentId = tostring(ProtoPayload['metadata']['parentDelta']['destinationParent']['id']), MetadataParentDeltaDestinationParentType = tostring(ProtoPayload['metadata']['parentDelta']['destinationParent']['type']), MetadataParentDeltaSourceParentId = tostring(ProtoPayload['metadata']['parentDelta']['sourceParent']['id']), MetadataParentDeltaSourceParentType = tostring(ProtoPayload['metadata']['parentDelta']['sourceParent']['type']), RequestType = tostring(ProtoPayload['request']['@type']), RequestResource = tostring(ProtoPayload['request']['resource']), RequestName = tostring(ProtoPayload['request']['name']), RequestCreateTime = todatetime(ProtoPayload['request']['createTime']), RequestLifecycleState = tostring(ProtoPayload['request']['lifecycleState']), RequestProjectId = tostring(ProtoPayload['request']['projectId']), RequestParent = tostring(ProtoPayload['request']['parent']), RequestListValue = tostring(ProtoPayload['request']['listValue']), RequestPageSize = tostring(ProtoPayload['request']['pageSize']), RequestCustomConstraint = tostring(ProtoPayload['request']['customConstraint']), RequestDestinationParent = tostring(ProtoPayload['request']['destinationParent']), RequestUpdateMask = tostring(ProtoPayload['request']['updateMask']), RequestConstraint = tostring(ProtoPayload['request']['constraint']), RequestQuery = tostring(ProtoPayload['request']['query']), RequestPolicyAuditConfigs = tostring(ProtoPayload['request']['policy']['auditConfigs']), RequestPolicyBindings = tostring(ProtoPayload['request']['policy']['bindings']), RequestPolicyEtag = tostring(ProtoPayload['request']['policy']['etag']), RequestPolicyName = tostring(ProtoPayload['request']['policy']['name']), RequestPolicySpec = tostring(ProtoPayload['request']['policy']['spec']), RequestOptionsRequestedPolicyVersion = tostring(ProtoPayload['request']['options']['requestedPolicyVersion']), RequestProjectName = tostring(ProtoPayload['request']['project']['name']), RequestProjectProjectId = tostring(ProtoPayload['request']['project']['projectId']), RequestProjectProjectNumber = tostring(ProtoPayload['request']['project']['projectNumber']), RequestProjectLifecycleState = tostring(ProtoPayload['request']['project']['lifecycleState']), RequestProjectCreateTime = todatetime(ProtoPayload['request']['project']['createTime']), RequestProjectLabels = tostring(ProtoPayload['request']['project']['labels']), RequestProjectParent = tostring(ProtoPayload['request']['project']['parent']), RequestFolderDisplayName = tostring(ProtoPayload['request']['folder']['displayName']), RequestFolderParent = tostring(ProtoPayload['request']['folder']['parent']), RequestTagValueName = tostring(ProtoPayload['request']['tagValue']['name']), RequestTagKeyName = tostring(ProtoPayload['request']['tagKey']['name']), RequestTagBindingTagValue = tostring(ProtoPayload['request']['tagBinding']['tagValue']), RequestTagBindingParent = tostring(ProtoPayload['request']['tagBinding']['parent']), RequestMetadataCallerIP = tostring(ProtoPayload['requestMetadata']['callerIp']), RequestMetadataCallerSuppliedUserAgent = tostring(ProtoPayload['requestMetadata']['callerSuppliedUserAgent']), RequestMetadataDestinationAttributes = tostring(ProtoPayload['requestMetadata']['destinationAttributes']), RequestMetadataRequestAttributesAuth = tostring(ProtoPayload['requestMetadata']['requestAttributes']['auth']), RequestMetadataRequestAttributesTime = todatetime(ProtoPayload['requestMetadata']['requestAttributes']['time']), RequestMetadataRequestAttributesReason = tostring(ProtoPayload['requestMetadata']['requestAttributes']['reason']), ResponseType = tostring(ProtoPayload['response']['@type']), ResponseAuditConfigs = tostring(ProtoPayload['response']['auditConfigs']), ResponseBindings = tostring(ProtoPayload['response']['bindings']), ResponseEtag = tostring(ProtoPayload['response']['etag']), ResponseCreateTime = todatetime(ProtoPayload['response']['createTime']), ResponseDisplayName = tostring(ProtoPayload['response']['displayName']), ResponseName = tostring(ProtoPayload['response']['name']), ResponseParent = tostring(ProtoPayload['response']['parent']), ResponseState = tostring(ProtoPayload['response']['state']), ResponseUpdateTime = todatetime(ProtoPayload['response']['updateTime']), ResponseLifecycleState = tostring(ProtoPayload['response']['lifecycleState']), ResponseProjectId = tostring(ProtoPayload['response']['projectId']), ResponseProjectNumber = tostring(ProtoPayload['response']['projectNumber']), ResponseLabels = tostring(ProtoPayload['response']['labels']), ResponseDescription = tostring(ProtoPayload['response']['description']), ResponseNamespacedName = tostring(ProtoPayload['response']['namespacedName']), ResponseShortName = tostring(ProtoPayload['response']['shortName']), ResponseTagKey = tostring(ProtoPayload['response']['tagKey']), ResponseTagValue = tostring(ProtoPayload['response']['tagValue']), ResponseTagValueNamespacedName = tostring(ProtoPayload['response']['tagValueNamespacedName']), ResponsePolicySpec = tostring(ProtoPayload['response']['policy']['spec']), ServiceDataType = tostring(ProtoPayload['serviceData']['@type']), ServiceDataPolicyDeltaBindingDeltas = tostring(ProtoPayload['serviceData']['policyDelta']['bindingDeltas']), GCPResourceType = tostring(Resource['type']), ResourceLabelsOrganizationId = tostring(Resource['labels']['organization_id']), ResourceLabelsFolderId = tostring(Resource['labels']['folder_id']), ResourceLabelsProjectId = tostring(Resource['labels']['project_id']), ResourceLabelsMethod = tostring(Resource['labels']['method']), ResourceLabelsService = tostring(Resource['labels']['service']), OperationFirst = tobool(Operation['first']), OperationLast = tobool(Operation['last']), OperationID = tostring(Operation['id']), OperationProducer = tostring(Operation['producer']) 
| project TimeGenerated, InsertID, LogName, ReceiveTimestamp, Severity, Timestamp, PayloadType, MethodName, GCPResourceName, ServiceName, NumResponseItems, AuthenticationInfoPrincipalEmail, AuthenticationInfoPrincipalSubject, AuthenticationInfoServiceAccountKeyName, AuthorizationInfo, Status, MetadataType, MetadataParentDeltaDestinationParentId, MetadataParentDeltaDestinationParentType, MetadataParentDeltaSourceParentId, MetadataParentDeltaSourceParentType, RequestType, RequestResource, RequestName, RequestCreateTime, RequestLifecycleState, RequestProjectId, RequestParent, RequestListValue, RequestPageSize, RequestCustomConstraint, RequestDestinationParent, RequestUpdateMask, RequestConstraint, RequestQuery, RequestPolicyAuditConfigs, RequestPolicyBindings, RequestPolicyEtag, RequestPolicyName, RequestPolicySpec, RequestOptionsRequestedPolicyVersion, RequestProjectName, RequestProjectProjectId, RequestProjectProjectNumber, RequestProjectLifecycleState, RequestProjectCreateTime, RequestProjectLabels, RequestProjectParent, RequestFolderDisplayName, RequestFolderParent, RequestTagValueName, RequestTagKeyName, RequestTagBindingTagValue, RequestTagBindingParent, RequestMetadataCallerIP, RequestMetadataCallerSuppliedUserAgent, RequestMetadataDestinationAttributes, RequestMetadataRequestAttributesAuth, RequestMetadataRequestAttributesTime, RequestMetadataRequestAttributesReason, ResponseType, ResponseAuditConfigs, ResponseBindings, ResponseEtag, ResponseCreateTime, ResponseDisplayName, ResponseName, ResponseParent, ResponseState, ResponseUpdateTime, ResponseLifecycleState, ResponseProjectId, ResponseProjectNumber, ResponseLabels, ResponseDescription, ResponseNamespacedName, ResponseShortName, ResponseTagKey, ResponseTagValue, ResponseTagValueNamespacedName, ResponsePolicySpec, ServiceDataType, ServiceDataPolicyDeltaBindingDeltas, GCPResourceType, ResourceLabelsOrganizationId, ResourceLabelsFolderId, ResourceLabelsProjectId, ResourceLabelsMethod, ResourceLabelsService, OperationFirst, OperationLast, OperationID, OperationProducer