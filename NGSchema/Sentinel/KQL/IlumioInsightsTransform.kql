source
| extend InsightsParsed = parse_json(Insights)
| extend 
    Name = tostring(InsightsParsed.Name),
    Service = tostring(InsightsParsed.Service),
    Port = toint(InsightsParsed.Port),
    DestLabel = tostring(InsightsParsed.DestLabel),
    TotalReceivedBytes = toint(InsightsParsed.TotalReceivedBytes),
    DestCountry = tostring(InsightsParsed.DestCountry),
    DestPort = toint(InsightsParsed.DestPort),
    SrcThreatLevel = tostring(InsightsParsed.SrcThreatLevel),
    SrcCity = tostring(InsightsParsed.SrcCity),
    DestThreatLevel = tostring(InsightsParsed.DestThreatLevel),
    SrcPort = toint(InsightsParsed.SrcPort),
    VEScore = todouble(InsightsParsed.VEScore),
    DestIsWellKnown = tobool(InsightsParsed.DestIsWellKnown),
    FlowCount = toint(InsightsParsed.FlowCount),
    CvssSeverity = tostring(InsightsParsed.CvssSeverity),
    SrcIP = tostring(InsightsParsed.SrcIP),
    DestIP = tostring(InsightsParsed.DestIP),
    UniqueId = tostring(InsightsParsed.UniqueId),
    DestCity = tostring(InsightsParsed.DestCity),
    SrcIsWellKnown = tobool(InsightsParsed.SrcIsWellKnown),
    TimeGenerated = todatetime(InsightsParsed.TimeGenerated),
    Status = tostring(InsightsParsed.Status),
    SrcLabel = tostring(InsightsParsed.SrcLabel),
    Proto = tostring(InsightsParsed.Proto),
    TotalSentBytes = toint(InsightsParsed.TotalSentBytes),
    SrcCountry = tostring(InsightsParsed.SrcCountry)
| project TimeGenerated, Name, AzureResourceId=ResourceId, ResourceInternalId, IllumioTenantId, ResourceTenantId, 
          ResourceSubId, ResourceRegion, ResourceVnetId, IllumioUrl,
          Service, Port, DestLabel, TotalReceivedBytes, DestCountry, DestPort,
          SrcThreatLevel, SrcCity, DestThreatLevel, SrcPort, VEScore, DestIsWellKnown,
          FlowCount, CvssSeverity, SrcIP, DestIP, UniqueId, DestCity, SrcIsWellKnown,
          Status, SrcLabel, Proto, TotalSentBytes, SrcCountry
