{
	"type": "Microsoft.SecurityInsights/PowerPlatform",
	"displayName": "Microsoft Sentinel Power Platform.",
	"description": "Audit logs for Power Platform collected by Microsoft Sentinel.",
	"tags": {},
	"properties": {},
	"simplifiedSchemaVersion": "3",
	"icmTeam": "Microsoft Azure Sentinel/SAP",
	"contactDL": "sentinel4dynamics365@microsoft.com",
	"relatedTables": [],
	"relatedFunctions": [],
	"tables": [
		{
			"name": "PowerAppsActivity",
			"description": "Contains Microsoft Power Apps activity logs that track events like creation, deletion, updates, permission changes, and app launches.",
			"categories": [
				"security",
				"audit"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 6,
			"dataTypeId": "OFFICEPOWERAPPS_RESTAPI",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"isTroubleshootingAllowed": true,
			"isLakeAllowed": true,
			"tableState": "Validation",
			"input": [
				{
					"name": "Id",
					"type": "String"
				},
				{
					"name": "RecordType",
					"type": "Int"
				},
				{
					"name": "CreationTime",
					"type": "DateTime"
				},
				{
					"name": "Operation",
					"type": "String"
				},
				{
					"name": "ResultStatus",
					"type": "String"
				},
				{
					"name": "OrganizationId",
					"type": "String"
				},
				{
					"name": "UserType",
					"type": "Int"
				},
				{
					"name": "UserKey",
					"type": "String"
				},
				{
					"name": "Workload",
					"type": "String"
				},
				{
					"name": "UserId",
					"type": "String"
				},
				{
					"name": "ClientIP",
					"type": "String"
				},
				{
					"name": "ObjectId",
					"type": "String"
				},
				{
					"name": "AppName",
					"type": "String"
				},
				{
					"name": "AdditionalInfo",
					"type": "Dynamic"
				},
				{
					"name": "Version",
					"type": "Int"
				}
			],
			"transformFilePath": "KQL/Office365PowerAppsTransform.kql",
			"columns": [
				{
					"name": "EventOriginalUid",
					"type": "String",
					"description": "Unique identifier of an audit record.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "RecordType",
					"type": "String",
					"description": "The type of operation indicated by the record. See the AuditLogRecordType table for details on the types of audit log records."
				},
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "The date and time in (UTC) when the user performed the activity."
				},
				{
					"name": "EventOriginalType",
					"type": "String",
					"description": "The name of the user or admin activity that performed the activity. For a description of the most common operations/activities, see \"Search the audit log\" in the Office 365 Protection Center. For Exchange admin activity, this property identifies the name of the cmdlet that was run. For Dlp events, this can be \"DlpRuleMatch\", \"DlpRuleUndo\" or \"DlpInfo\", which are described under \"DLP schema\" below."
				},
				{
					"name": "OrganizationId",
					"type": "String",
					"description": "The GUID for your organization's Office 365 tenant. This value will always be the same for your organization, regardless of the Office 365 service in which it occurs.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ActorUserType",
					"type": "String",
					"description": "The type of user that performed the operation. For example: Admin, System, Application, Service Principal, Guest or Other."
				},
				{
					"name": "ActorUserId",
					"type": "String",
					"description": "An alternative ID for the user identified in the UserId property. For example, this property is populated with the passport unique ID (PUID) for events performed by users in SharePoint, OneDrive for Business, and Exchange. This property may also specify the same value as the UserID property for events occurring in other services and events performed by system accounts.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "EventResult",
					"type": "String",
					"description": "Indicates whether the action (specified in the Operation property) was successful or not. Possible values are Succeeded, PartiallySucceeded, or Failed."
				},
				{
					"name": "ObjectId",
					"type": "String",
					"description": "The full path name of the file or folder accessed by the user. For Exchange admin audit logging, the name of the object that was modified by the cmdlet.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ActorName",
					"type": "String",
					"description": "The UPN (User Principal Name) of the user who performed the action (specified in the Operation property) that resulted in the record being logged; for example, my_name@my_domain_name. Note that records for activity performed by system accounts (such as SHAREPOINT\\system or NT AUTHORITY\\SYSTEM) are also included. In SharePoint, another value display in the UserId property is app@sharepoint. This indicates that the \"user\" who performed the activity was an application that has the necessary permissions in SharePoint to perform organization-wide actions (such as search a SharePoint site or OneDrive account) on behalf of a user, admin, or service. For more information, see the app@sharepoint user in audit records."
				},
				{
					"name": "SrcIpAddr",
					"type": "String",
					"description": "The IP address of the device that was used when the activity was logged. The IP address is displayed in either an IPv4 or IPv6 address format. For some services, the value displayed in this property might be the IP address for a trusted application (for example, Office on the web apps) calling into the service on behalf of a user and not the IP address of the device used by person who performed the activity. Also, for Azure Active Directory-related events, the IP address isn't logged and the value for the ClientIP property is null.",
					"dataTypeHint": "IP"
				},
				{
					"name": "TargetAppName",
					"type": "String",
					"description": "The name of the app where the event occurred.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "Workload",
					"type": "String",
					"description": "The Office 365 service where the activity occurred."
				},
				{
					"name": "AdditionalInfo",
					"type": "Dynamic",
					"description": "Additional information if any (e.g. the environment name)"
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/Office365PowerAppsSample.json",
			"sampleOutputRecordsFilePath": "SampleOutputRecords/Office365PowerAppsSample.json"
		},
		{
			"name": "PowerAutomateActivity",
			"description": "Contains Microsoft Power Automate audit logs. It's typically used to track Power Automate activities.",
			"categories": [
				"security",
				"audit"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 5,
			"dataTypeId": "OFFICEPOWERAUTOMATE_RESTAPI",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"tableState": "Validation",
			"isTroubleshootingAllowed": true,
			"isLakeAllowed": true,
			"input": [
				{
					"name": "CreationTime",
					"type": "DateTime"
				},
				{
					"name": "Id",
					"type": "String"
				},
				{
					"name": "Operation",
					"type": "String"
				},
				{
					"name": "OrganizationId",
					"type": "String"
				},
				{
					"name": "RecordType",
					"type": "Int"
				},
				{
					"name": "ResultStatus",
					"type": "String"
				},
				{
					"name": "UserKey",
					"type": "String"
				},
				{
					"name": "UserType",
					"type": "Int"
				},
				{
					"name": "Version",
					"type": "Int"
				},
				{
					"name": "Workload",
					"type": "String"
				},
				{
					"name": "ObjectId",
					"type": "String"
				},
				{
					"name": "UserId",
					"type": "String"
				},
				{
					"name": "FlowConnectorNames",
					"type": "String"
				},
				{
					"name": "FlowDetailsUrl",
					"type": "String"
				},
				{
					"name": "LicenseDisplayName",
					"type": "String"
				},
				{
					"name": "RecipientUPN",
					"type": "String"
				},
				{
					"name": "SharingPermission",
					"type": "Int"
				},
				{
					"name": "UserTypeInitiated",
					"type": "Int"
				},
				{
					"name": "UserUPN",
					"type": "String"
				},
				{
					"name": "ClientIP",
					"type": "String"
				},
				{
					"name": "AdditionalInfo",
					"type": "Dynamic"
				}
			],
			"transformFilePath": "KQL/Office365PowerAutomateTransform.kql",
			"columns": [
				{
					"name": "EventOriginalUid",
					"type": "String",
					"description": "Unique identifier of an audit record.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "RecordType",
					"type": "String",
					"description": "The type of operation indicated by the record. See the AuditLogRecordType table for details on the types of audit log records."
				},
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "The date and time in (UTC) when the user performed the activity."
				},
				{
					"name": "EventOriginalType",
					"type": "String",
					"description": "The name of the user or admin activity that performed the activity. For a description of the most common operations/activities, see \"Search the audit log\" in the Office 365 Protection Center. For Exchange admin activity, this property identifies the name of the cmdlet that was run. For Dlp events, this can be \"DlpRuleMatch\", \"DlpRuleUndo\" or \"DlpInfo\", which are described under \"DLP schema\" below."
				},
				{
					"name": "OrganizationId",
					"type": "String",
					"description": "The GUID for your organization's Office 365 tenant. This value will always be the same for your organization, regardless of the Office 365 service in which it occurs.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ActorUserType",
					"type": "String",
					"description": "The type of user that performed the operation. Possible types are: Admin, System, Application, Service Principal and Other."
				},
				{
					"name": "ActorUserId",
					"type": "String",
					"description": "An alternative ID for the user identified in the UserId property. For example, this property is populated with the passport unique ID (PUID) for events performed by users in SharePoint, OneDrive for Business, and Exchange. This property may also specify the same value as the UserID property for events occurring in other services and events performed by system accounts.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "EventResult",
					"type": "String",
					"description": "Indicates whether the action (specified in the Operation property) was successful or not. Possible values are Succeeded, PartiallySucceeded, or Failed."
				},
				{
					"name": "ObjectId",
					"type": "String",
					"description": "The full path name of the file or folder accessed by the user. For Exchange admin audit logging, the name of the object that was modified by the cmdlet.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ActorName",
					"type": "String",
					"description": "The UPN (User Principal Name) of the user who performed the action (specified in the Operation property) that resulted in the record being logged; for example, my_name@my_domain_name. Note that records for activity performed by system accounts (such as SHAREPOINT\\system or NT AUTHORITY\\SYSTEM) are also included. In SharePoint, another value display in the UserId property is app@sharepoint. This indicates that the \"user\" who performed the activity was an application that has the necessary permissions in SharePoint to perform organization-wide actions (such as search a SharePoint site or OneDrive account) on behalf of a user, admin, or service. For more information, see the app@sharepoint user in audit records."
				},
				{
					"name": "SrcIpAddr",
					"type": "String",
					"description": "The IP address of the device that was used when the activity was logged. The IP address is displayed in either an IPv4 or IPv6 address format. For some services, the value displayed in this property might be the IP address for a trusted application (for example, Office on the web apps) calling into the service on behalf of a user and not the IP address of the device used by person who performed the activity. Also, for Azure Active Directory-related events, the IP address isn't logged and the value for the ClientIP property is null.",
					"dataTypeHint": "IP"
				},
				{
					"name": "RecipientUpn",
					"type": "String",
					"description": "If permission was updated, shows the UPN of the permission recipient."
				},
				{
					"name": "FlowConnectorNames",
					"type": "String",
					"description": "Connector names listed in the flow."
				},
				{
					"name": "FlowDetailsUrl",
					"type": "String",
					"description": "Link to the flow's details page.",
					"dataTypeHint": "URI"
				},
				{
					"name": "LicenseDisplayName",
					"type": "String",
					"description": "Display name of the license."
				},
				{
					"name": "SharingPermission",
					"type": "String",
					"description": "Type of permission shared with another user (3 = Owner/ReadWrite, 2 = Run-only user/Read)."
				},
				{
					"name": "UserUpn",
					"type": "String",
					"description": "Unique ID of the user. Always equivalent to UserKey."
				},
				{
					"name": "Workload",
					"type": "String",
					"description": "The Office 365 service where the activity occurred."
				},
				{
					"name": "AdditionalInfo",
					"type": "Dynamic",
					"description": "More information, for example, the environment name."
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/Office365PowerAutomateSample.json",
			"sampleOutputRecordsFilePath": "SampleOutputRecords/Office365PowerAutomateSample.json"
		},
		{
			"name": "PowerPlatformDlpActivity",
			"description": "Contains Microsoft Power Platform Data Loss Prevention (DLP) audit logs. It's typically used to track Power Platform DLP admin activities.",
			"categories": [
				"security",
				"audit"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 5,
			"dataTypeId": "OFFICEPOWERPLATFORMADMINDLP_RESTAPI",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"isTroubleshootingAllowed": true,
			"isLakeAllowed": true,
			"tableState": "Validation",
			"input": [
				{
					"name": "CreationTime",
					"type": "DateTime"
				},
				{
					"name": "Id",
					"type": "String"
				},
				{
					"name": "Operation",
					"type": "String"
				},
				{
					"name": "OrganizationId",
					"type": "String"
				},
				{
					"name": "RecordType",
					"type": "Int"
				},
				{
					"name": "ResultStatus",
					"type": "String"
				},
				{
					"name": "UserKey",
					"type": "String"
				},
				{
					"name": "UserType",
					"type": "Int"
				},
				{
					"name": "Version",
					"type": "Int"
				},
				{
					"name": "Workload",
					"type": "String"
				},
				{
					"name": "ObjectId",
					"type": "String"
				},
				{
					"name": "UserId",
					"type": "String"
				},
				{
					"name": "Name",
					"type": "String"
				},
				{
					"name": "ClientIP",
					"type": "String"
				},
				{
					"name": "AdditionalInfo",
					"type": "Dynamic"
				}
			],
			"transformFilePath": "KQL/Office365PowerPlatformAdminDlpTransform.kql",
			"columns": [
				{
					"name": "EventOriginalUid",
					"type": "String",
					"description": "Unique identifier of an audit record.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "RecordType",
					"type": "String",
					"description": "The type of operation indicated by the record. See the AuditLogRecordType table for details on the types of audit log records."
				},
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "The date and time in (UTC) when the user performed the activity."
				},
				{
					"name": "EventOriginalType",
					"type": "String",
					"description": "The name of the user or admin activity that performed the activity. For a description of the most common operations/activities, see \"Search the audit log\" in the Office 365 Protection Center. For Exchange admin activity, this property identifies the name of the cmdlet that was run. For Dlp events, this can be \"DlpRuleMatch\", \"DlpRuleUndo\" or \"DlpInfo\", which are described under \"DLP schema\" below."
				},
				{
					"name": "OrganizationId",
					"type": "String",
					"description": "The GUID for your organization's Office 365 tenant. This value will always be the same for your organization, regardless of the Office 365 service in which it occurs.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ActorUserType",
					"type": "String",
					"description": "The type of user that performed the operation. Possible types are: Admin, System, Application, Service Principal and Other."
				},
				{
					"name": "ActorUserId",
					"type": "String",
					"description": "An alternative ID for the user identified in the UserId property. For example, this property is populated with the passport unique ID (PUID) for events performed by users in SharePoint, OneDrive for Business, and Exchange. This property may also specify the same value as the UserID property for events occurring in other services and events performed by system accounts.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "EventResult",
					"type": "String",
					"description": "Indicates whether the action (specified in the Operation property) was successful or not. Possible values are Succeeded, PartiallySucceeded, or Failed."
				},
				{
					"name": "ObjectId",
					"type": "String",
					"description": "The full path name of the file or folder accessed by the user. For Exchange admin audit logging, the name of the object that was modified by the cmdlet.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ActorName",
					"type": "String",
					"description": "The UPN (User Principal Name) of the user who performed the action (specified in the Operation property) that resulted in the record being logged; for example, my_name@my_domain_name. Note that records for activity performed by system accounts (such as SHAREPOINT\\system or NT AUTHORITY\\SYSTEM) are also included. In SharePoint, another value display in the UserId property is app@sharepoint. This indicates that the \"user\" who performed the activity was an application that has the necessary permissions in SharePoint to perform organization-wide actions (such as search a SharePoint site or OneDrive account) on behalf of a user, admin, or service. For more information, see the app@sharepoint user in audit records."
				},
				{
					"name": "SrcIpAddr",
					"type": "String",
					"description": "The IP address of the device that was used when the activity was logged. The IP address is displayed in either an IPv4 or IPv6 address format. For some services, the value displayed in this property might be the IP address for a trusted application (for example, Office on the web apps) calling into the service on behalf of a user and not the IP address of the device used by person who performed the activity. Also, for Azure Active Directory-related events, the IP address isn't logged and the value for the ClientIP property is null.",
					"dataTypeHint": "IP"
				},
				{
					"name": "Workload",
					"type": "String",
					"description": "The Office 365 service where the activity occurred."
				},
				{
					"name": "PolicyName",
					"type": "String",
					"description": "Name of the DLP policy."
				},
				{
					"name": "AdditionalInfo",
					"type": "Dynamic",
					"description": "More information, for example, the environment name."
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/Office365PowerPlatformAdminDlpSample.json",
			"sampleOutputRecordsFilePath": "SampleOutputRecords/Office365PowerPlatformAdminDlpSample.json"
		},
		{
			"name": "PowerPlatformConnectorActivity",
			"description": "Contains Microsoft Power Platform Connector audit logs. It's typically used to track Power Platform Connector activities.",
			"categories": [
				"security",
				"audit"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 6,
			"dataTypeId": "OFFICEPOWERAPPSRESOURCE_RESTAPI",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"isTroubleshootingAllowed": true,
			"isLakeAllowed": true,
			"tableState": "Validation",
			"input": [
				{
					"name": "CreationTime",
					"type": "DateTime"
				},
				{
					"name": "Id",
					"type": "String"
				},
				{
					"name": "Operation",
					"type": "String"
				},
				{
					"name": "OrganizationId",
					"type": "String"
				},
				{
					"name": "RecordType",
					"type": "Int"
				},
				{
					"name": "ResultStatus",
					"type": "String"
				},
				{
					"name": "UserKey",
					"type": "String"
				},
				{
					"name": "UserType",
					"type": "Int"
				},
				{
					"name": "Version",
					"type": "Int"
				},
				{
					"name": "Workload",
					"type": "String"
				},
				{
					"name": "ObjectId",
					"type": "String"
				},
				{
					"name": "UserId",
					"type": "String"
				},
				{
					"name": "ResourceId",
					"type": "String"
				},
				{
					"name": "ClientIP",
					"type": "String"
				},
				{
					"name": "AdditionalInfo",
					"type": "Dynamic"
				}
			],
			"transformFilePath": "KQL/Office365PowerAppsResourceTransform.kql",
			"columns": [
				{
					"name": "EventOriginalUid",
					"type": "String",
					"description": "Unique identifier of an audit record.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "RecordType",
					"type": "String",
					"description": "The type of operation indicated by the record. See the AuditLogRecordType table for details on the types of audit log records."
				},
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "The date and time in (UTC) when the user performed the activity."
				},
				{
					"name": "EventOriginalType",
					"type": "String",
					"description": "The name of the user or admin activity that performed the activity. For a description of the most common operations/activities, see \"Search the audit log\" in the Office 365 Protection Center. For Exchange admin activity, this property identifies the name of the cmdlet that was run. For Dlp events, this can be \"DlpRuleMatch\", \"DlpRuleUndo\" or \"DlpInfo\", which are described under \"DLP schema\" below."
				},
				{
					"name": "OrganizationId",
					"type": "String",
					"description": "The GUID for your organization's Office 365 tenant. This value will always be the same for your organization, regardless of the Office 365 service in which it occurs.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ActorUserType",
					"type": "String",
					"description": "The type of user that performed the operation. Possible types are: Admin, System, Application, Service Principal and Other."
				},
				{
					"name": "ActorUserId",
					"type": "String",
					"description": "An alternative ID for the user identified in the UserId property. For example, this property is populated with the passport unique ID (PUID) for events performed by users in SharePoint, OneDrive for Business, and Exchange. This property may also specify the same value as the UserID property for events occurring in other services and events performed by system accounts.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "EventResult",
					"type": "String",
					"description": "Indicates whether the action (specified in the Operation property) was successful or not. Possible values are Succeeded, PartiallySucceeded, or Failed."
				},
				{
					"name": "ObjectId",
					"type": "String",
					"description": "The full path name of the file or folder accessed by the user. For Exchange admin audit logging, the name of the object that was modified by the cmdlet.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ActorName",
					"type": "String",
					"description": "The UPN (User Principal Name) of the user who performed the action (specified in the Operation property) that resulted in the record being logged; for example, my_name@my_domain_name. Note that records for activity performed by system accounts (such as SHAREPOINT\\system or NT AUTHORITY\\SYSTEM) are also included. In SharePoint, another value display in the UserId property is app@sharepoint. This indicates that the \"user\" who performed the activity was an application that has the necessary permissions in SharePoint to perform organization-wide actions (such as search a SharePoint site or OneDrive account) on behalf of a user, admin, or service. For more information, see the app@sharepoint user in audit records."
				},
				{
					"name": "SrcIpAddr",
					"type": "String",
					"description": "The IP address of the device that was used when the activity was logged. The IP address is displayed in either an IPv4 or IPv6 address format. For some services, the value displayed in this property might be the IP address for a trusted application (for example, Office on the web apps) calling into the service on behalf of a user and not the IP address of the device used by person who performed the activity. Also, for Azure Active Directory-related events, the IP address isn't logged and the value for the ClientIP property is null.",
					"dataTypeHint": "IP"
				},
				{
					"name": "Workload",
					"type": "String",
					"description": "The Office 365 service where the activity occurred."
				},
				{
					"name": "ConnectorId",
					"type": "String",
					"description": "The unique ID of the resource. Examples: custom api, and connection or gateway."
				},
				{
					"name": "AdditionalInfo",
					"type": "Dynamic",
					"description": "More information, for example, the environment name."
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/Office365PowerAppsResourceSample.json",
			"sampleOutputRecordsFilePath": "SampleOutputRecords/Office365PowerAppsResourceSample.json"
		},
		{
			"name": "DataverseActivity",
			"description": "Contains Microsoft Dataverse audit logs. It's typically used to track Dataverse and Dynamics 365 activities.",
			"categories": [
				"security",
				"audit"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 3,
			"dataTypeId": "OFFICEDATAVERSE_RESTAPI",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"isTroubleshootingAllowed": true,
			"isLakeAllowed": true,
			"tableState": "Production",
			"input": [
				{
					"name": "CreationTime",
					"type": "DateTime"
				},
				{
					"name": "ClientIP",
					"type": "String"
				},
				{
					"name": "CorrelationId",
					"type": "String"
				},
				{
					"name": "CrmOrganizationUniqueName",
					"type": "String"
				},
				{
					"name": "EntityId",
					"type": "String"
				},
				{
					"name": "EntityName",
					"type": "String"
				},
				{
					"name": "Fields",
					"type": "Dynamic"
				},
				{
					"name": "Id",
					"type": "String"
				},
				{
					"name": "InstanceUrl",
					"type": "String"
				},
				{
					"name": "ItemType",
					"type": "String"
				},
				{
					"name": "ItemUrl",
					"type": "String"
				},
				{
					"name": "Message",
					"type": "String"
				},
				{
					"name": "ObjectId",
					"type": "String"
				},
				{
					"name": "Operation",
					"type": "String"
				},
				{
					"name": "OrganizationId",
					"type": "String"
				},
				{
					"name": "PrimaryFieldValue",
					"type": "String"
				},
				{
					"name": "Query",
					"type": "String"
				},
				{
					"name": "QueryResults",
					"type": "Dynamic"
				},
				{
					"name": "RecordType",
					"type": "Int"
				},
				{
					"name": "ResultStatus",
					"type": "String"
				},
				{
					"name": "ServiceContextId",
					"type": "String"
				},
				{
					"name": "ServiceContextIdType",
					"type": "String"
				},
				{
					"name": "ServiceName",
					"type": "String"
				},
				{
					"name": "SystemUserId",
					"type": "String"
				},
				{
					"name": "UserAgent",
					"type": "String"
				},
				{
					"name": "UserId",
					"type": "String"
				},
				{
					"name": "UserKey",
					"type": "String"
				},
				{
					"name": "UserType",
					"type": "Int"
				},
				{
					"name": "UserUpn",
					"type": "String"
				},
				{
					"name": "Version",
					"type": "Int"
				},
				{
					"name": "Workload",
					"type": "String"
				}
			],
			"transformFilePath": "KQL/Office365DataverseTransform.kql",
			"columns": [
				{
					"name": "SourceRecordId",
					"type": "String",
					"description": "Unique identifier of an audit record.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "UserAgent",
					"type": "String",
					"description": "The user agent."
				},
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "The date and time in (UTC) when the user performed the activity."
				},
				{
					"name": "Operation",
					"type": "String",
					"description": "The name of the operation that the user is performing."
				},
				{
					"name": "OrganizationId",
					"type": "String",
					"description": "The GUID for your organization's Office 365 tenant. This value will always be the same for your organization.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "UserType",
					"type": "String",
					"description": "The type of user that performed the operation. See the UserType table in Office 365 management activity api schema documentation for details on the types of users."
				},
				{
					"name": "UserKey",
					"type": "String",
					"description": "An alternative ID for the user identified in the UserId property."
				},
				{
					"name": "ResultStatus",
					"type": "String",
					"description": "Indicates whether the action (specified in the Operation property) was successful or not."
				},
				{
					"name": "OriginalObjectId",
					"type": "String",
					"description": "The ObjectId for Dataverse operation or business activity."
				},
				{
					"name": "UserId",
					"type": "String",
					"description": "The Dataverse user ID of the user who performed the action (specified in the Operation property) that resulted in the record being logged."
				},
				{
					"name": "UserUpn",
					"type": "String",
					"description": "The UPN (User Principal Name) of the user who performed the action (specified in the Operation property) that resulted in the record being logged."
				},
				{
					"name": "ClientIp",
					"type": "String",
					"description": "The IP address of the device that was used when the activity was logged.",
					"dataTypeHint": "IP"
				},
				{
					"name": "CorrelationId",
					"type": "String",
					"description": "A unique value used to associate related rows.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "CrmOrganizationUniqueName",
					"type": "String",
					"description": "Unique name of the organization."
				},
				{
					"name": "InstanceUrl",
					"type": "String",
					"description": "URL to the instance.",
					"dataTypeHint": "URI"
				},
				{
					"name": "ItemUrl",
					"type": "String",
					"description": "URL to the record emitting the log.",
					"dataTypeHint": "URI"
				},
				{
					"name": "ItemType",
					"type": "String",
					"description": "The type of object that was accessed or modified. See the ItemType table for details on the types of objects."
				},
				{
					"name": "Message",
					"type": "String",
					"description": "Name of the message called in the Dynamics 365 SDK."
				},
				{
					"name": "EntityId",
					"type": "String",
					"description": "Unique identifier of the entity.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "EntityName",
					"type": "String",
					"description": "Name of the entity in the organization."
				},
				{
					"name": "Fields",
					"type": "Dynamic",
					"description": "JSON of Key Value pair reflecting the values that were created or updated."
				},
				{
					"name": "Query",
					"type": "String",
					"description": "The query filter parameters used while executing the FetchXML."
				},
				{
					"name": "QueryResults",
					"type": "Dynamic",
					"description": "One or multiple unique records returned by the Retrieve and Retrieve Multiple SDK message call."
				},
				{
					"name": "ServiceContextId",
					"type": "String",
					"description": "The unique id associated with service context.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ServiceContextIdType",
					"type": "String",
					"description": "Application defined token to define context use."
				},
				{
					"name": "ServiceName",
					"type": "String",
					"description": "Name of the Service generating the log."
				},
				{
					"name": "SystemUserId",
					"type": "String",
					"description": "Unique identifier of the user GUID in the organization.",
					"dataTypeHint": "GUID"
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/Office365DataverseSample.json",
			"sampleOutputRecordsFilePath": "SampleOutputRecords/Office365DataverseSample.json"
		},
		{
			"name": "PowerPlatformAdminActivity",
			"description": "Contains Microsoft Power Platform administrative activity logs that track events like creation, deletion, updates, to the Microsoft Power Platform environment.",
			"categories": [
				"security",
				"audit"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 4,
			"dataTypeId": "OFFICEPOWERPLATFORMADMIN_RESTAPI",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"isTroubleshootingAllowed": true,
			"isLakeAllowed": true,
			"tableState": "Production",
			"input": [
				{
					"name": "Id",
					"type": "String"
				},
				{
					"name": "EnvironmentId",
					"type": "String"
				},
				{
					"name": "RecordType",
					"type": "Int"
				},
				{
					"name": "CreationTime",
					"type": "DateTime"
				},
				{
					"name": "Operation",
					"type": "String"
				},
				{
					"name": "ResultStatus",
					"type": "String"
				},
				{
					"name": "OrganizationId",
					"type": "String"
				},
				{
					"name": "UserType",
					"type": "Int"
				},
				{
					"name": "UserKey",
					"type": "String"
				},
				{
					"name": "Workload",
					"type": "String"
				},
				{
					"name": "UserId",
					"type": "String"
				},
				{
					"name": "RequiresCustomerKeyEncryption",
					"type": "Bool"
				},
				{
					"name": "PropertyCollection",
					"type": "Dynamic"
				},
				{
					"name": "JsonPropertiesCollection",
					"type": "String"
				},
				{
					"name": "Version",
					"type": "Int"
				}
			],
			"transformFilePath": "KQL/Office365PowerPlatformAdminActivityTransform.kql",
			"columns": [
				{
					"name": "EventOriginalUid",
					"type": "String",
					"description": "Unique identifier of an audit record.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "RecordType",
					"type": "String",
					"description": "The type of operation indicated by the record. See the AuditLogRecordType table for details on the types of audit log records."
				},
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "The date and time in (UTC) when the user performed the activity."
				},
				{
					"name": "EventOriginalType",
					"type": "String",
					"description": "The name of the user or admin activity that performed the activity. For a description of the most common operations/activities, see \"Search the audit log\" in the Office 365 Protection Center. For Exchange admin activity, this property identifies the name of the cmdlet that was run. For Dlp events, this can be \"DlpRuleMatch\", \"DlpRuleUndo\" or \"DlpInfo\", which are described under \"DLP schema\" below."
				},
				{
					"name": "OrganizationId",
					"type": "String",
					"description": "The GUID for your organization's Office 365 tenant. This value will always be the same for your organization, regardless of the Office 365 service in which it occurs.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ActorUserType",
					"type": "String",
					"description": "The type of user that performed the operation. For example: Admin, System, Application, Service Principal, Guest or Other."
				},
				{
					"name": "ActorUserId",
					"type": "String",
					"description": "An alternative ID for the user identified in the UserId property. For example, this property is populated with the passport unique ID (PUID) for events performed by users in SharePoint, OneDrive for Business, and Exchange. This property may also specify the same value as the UserID property for events occurring in other services and events performed by system accounts.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "EventResult",
					"type": "String",
					"description": "Indicates whether the action (specified in the Operation property) was successful or not. Possible values are Succeeded, PartiallySucceeded, or Failed."
				},
				{
					"name": "ActorName",
					"type": "String",
					"description": "The UPN (User Principal Name) of the user who performed the action (specified in the Operation property) that resulted in the record being logged; for example, my_name@my_domain_name. Note that records for activity performed by system accounts (such as SHAREPOINT\\system or NT AUTHORITY\\SYSTEM) are also included. In SharePoint, another value display in the UserId property is app@sharepoint. This indicates that the \"user\" who performed the activity was an application that has the necessary permissions in SharePoint to perform organization-wide actions (such as search a SharePoint site or OneDrive account) on behalf of a user, admin, or service. For more information, see the app@sharepoint user in audit records."
				},
				{
					"name": "Workload",
					"type": "String",
					"description": "The Office 365 service where the activity occurred."
				},
				{
					"name": "PropertyCollection",
					"type": "Dynamic",
					"description": "Additional information property bag for the event."
				},
				{
					"name": "Properties",
					"type": "Dynamic",
					"description": "Additional information properties with KQL friendly formatting."
				},
				{
					"name": "EnvironmentId",
					"type": "String",
					"description": "The unique identifier of the environment."
				},
				{
					"name": "RequiresCustomerKeyEncryption",
					"type": "Bool",
					"description": "Status of the Customer Key Encryption requirement for the event."
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/Office365PowerPlatformAdminSample.json",
			"sampleOutputRecordsFilePath": "SampleOutputRecords/Office365PowerPlatformAdminSample.json"
		}
	],
	"functions": [],
	"queries": [
		{
			"id": "d5eec317-3dee-4aa9-92ec-28af5f25242f",
			"displayName": "Power Apps events filtered activity type",
			"description": "Display events from more than one day ago, filtered by app launch activity events and summarized by user ID, app and environment.",
			"bodyFilePath": "KQL/Office365PowerAppsLaunchAppsQuery.kql",
			"categories": [
				"security",
				"audit"
			],
			"relatedTables": [
				"PowerAppsActivity"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "8c391e1d-f7d0-4a0b-bab1-a0fc8978e108",
			"displayName": "Power Platform DLP events filtered by by activity type",
			"description": "Display events from more than one day ago, filtered by CreateDlpPolicy activity type and summarized by user ID, policy name and policy type.",
			"bodyFilePath": "KQL/Office365PowerPlatformAdminDlpAddPolicyQuery.kql",
			"categories": [
				"security",
				"audit"
			],
			"relatedTables": [
				"PowerPlatformDlpActivity"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "af2a6875-f636-497f-a721-10070b187d3a",
			"displayName": "Power Platform Connector events filtered by by activity type",
			"description": "Display events from more than one day ago, filtered by PutConnection activity type and summarized by user ID and environment.",
			"bodyFilePath": "KQL/Office365PowerAppsResourceAddConnectorQuery.kql",
			"categories": [
				"security",
				"audit"
			],
			"relatedTables": [
				"PowerPlatformConnectorActivity"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "65800d1d-80dd-4792-a147-5ce60fdd84bb",
			"displayName": "Power Automate events filtered by activity type",
			"description": "Display events from more than one day ago, filtered CreateFlow activity type and summarized by user ID and flow details.",
			"bodyFilePath": "KQL/Office365PowerAutomateAddFlowQuery.kql",
			"categories": [
				"security",
				"audit"
			],
			"relatedTables": [
				"PowerAutomateActivity"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "9fb56969-bd66-46b7-9c43-1aae797a302a",
			"displayName": "Dataverse events filtered by operation type",
			"description": "Display events filtered by Create record operations and summarized by associated table name.",
			"bodyFilePath": "KQL/Office365DataverseQuery.kql",
			"categories": [
				"security",
				"audit"
			],
			"relatedTables": [
				"DataverseActivity"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "52f7ea87-5e0f-4366-90fa-d73f627b3bc6",
			"displayName": "Power Platform administration events",
			"description": "Display events summarized by operation type and the user who initiated the operation.",
			"bodyFilePath": "KQL/Office365PowerPlatformAdminActivityQuery.kql",
			"categories": [
				"security",
				"audit"
			],
			"relatedTables": [
				"PowerPlatformAdminActivity"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		}
	]
}