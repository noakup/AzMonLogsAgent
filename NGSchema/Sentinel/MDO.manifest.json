{
	"type": "Microsoft.SecurityInsights/MDO",
	"displayName": "Azure Sentinel MDO",
	"description": "All Microsoft Defender for Endpoints (MDO) tables related to Azure Sentinel.",
	"tags": {},
	"properties": {},
	"simplifiedSchemaVersion": "3",
	"icmTeam": "Microsoft Azure Sentinel/Data Collection and Processing",
	"relatedTables": [],
	"relatedFunctions": [],
	"tables": [
		{
			"name": "EmailAttachmentInfo",
			"description": "Office 365 attached emails information.",
			"categories": [
				"security"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 11,
			"dataTypeId": "TENANTMICROSOFTWINDOWSDEFENDERATP_ADVANCEDHUNTINGEMAILATTACHMENTINFO",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"tableState": "Production",
			"isTroubleshootingAllowed": true,
			"isLakeAllowed": true,
			"input": [
				{
					"name": "time",
					"type": "DateTime"
				},
				{
					"name": "tenantId",
					"type": "String"
				},
				{
					"name": "operationName",
					"type": "String"
				},
				{
					"name": "category",
					"type": "String"
				},
				{
					"name": "properties",
					"type": "String"
				}
			],
			"transformFilePath": "KQL/EmailAttachmentInfoTransform.kql",
			"columns": [
				{
					"name": "FileName",
					"type": "String",
					"description": "Name of the file that the recorded action was applied to."
				},
				{
					"name": "FileType",
					"type": "String",
					"description": "File extension type."
				},
				{
					"name": "NetworkMessageId",
					"type": "String",
					"description": "Unique identifier for the email, generated by Office 365.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "RecipientEmailAddress",
					"type": "String",
					"description": "Email address of the recipient, or email address of the recipient after distribution list expansion."
				},
				{
					"name": "RecipientObjectId",
					"type": "String",
					"description": "Email recipient unique identifier in Azure AD.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ReportId",
					"type": "String",
					"description": "Unique identifier for the event."
				},
				{
					"name": "SHA256",
					"type": "String",
					"description": "SHA-256 of the file that the recorded action was applied to."
				},
				{
					"name": "SenderDisplayName",
					"type": "String",
					"description": "Sender email address in the from header, which is visible to email recipients on their email clients."
				},
				{
					"name": "SenderObjectId",
					"type": "String",
					"description": "Sender email address in the from header, which is visible to email recipients on their email clients.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ThreatTypes",
					"type": "String",
					"description": "Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats."
				},
				{
					"name": "SenderFromAddress",
					"type": "String",
					"description": "Sender domain in the from header, which is visible to email recipients on their email clients."

				},
				{
					"name": "ThreatNames",
					"type": "String",
					"description": "Sender email address in the from header, which is visible to email recipients on their email clients."
				},
				{
					"name": "DetectionMethods",
					"type": "String",
					"description": "Sender email address in the from header, which is visible to email recipients on their email clients."
				},
				{
					"name": "FileSize",
					"type": "BigInt",
					"description": "Size of the file in bytes."
				},
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated.",
					"isDefaultDisplay": true
				},
				{
					"name": "Timestamp",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated.",
					"isHidden": true,
					"isDefaultDisplay": false
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/EmailAttachmentInfoSample.json"
		},
		{
			"name": "EmailEvents",
			"description": "Office 365 email events, including email delivery and blocking events.",
			"categories": [
				"security"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 14,
			"dataTypeId": "TENANTMICROSOFTWINDOWSDEFENDERATP_ADVANCEDHUNTINGEMAILEVENTS",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"tableState": "Production",
			"isTroubleshootingAllowed": true,
			"isLakeAllowed": true,
			"input": [
				{
					"name": "time",
					"type": "DateTime"
				},
				{
					"name": "tenantId",
					"type": "String"
				},
				{
					"name": "operationName",
					"type": "String"
				},
				{
					"name": "category",
					"type": "String"
				},
				{
					"name": "properties",
					"type": "Dynamic"
				}
			],
			"transformFilePath": "KQL/EmailEventsTransform.kql",
			"columns": [
				{
					"name": "AttachmentCount",
					"type": "Int",
					"description": "Number of attachments in the email."
				},
				{
					"name": "AuthenticationDetails",
					"type": "String",
					"description": "List of pass or fail verdicts by email authentication protocols like DMARC, DKIM, SPF or a combination of multiple authentication types (CompAuth)."
				},
				{
					"name": "AdditionalFields",
					"type": "Dynamic",
					"description": "Additional information about the entity or event."
				},
				{
					"name": "ConfidenceLevel",
					"type": "String",
					"description": "List of confidence levels of any spam or phishing verdicts. For spam, this column shows the spam confidence level (SCL), indicating if the email was skipped (-1), found to be not spam (0,1), found to be spam with moderate confidence (5,6), or found to be spam with high confidence (9). For phishing, this column displays whether the confidence level is \"High\" or \"Low\"."
				},
				{
					"name": "Connectors",
					"type": "String",
					"description": "Custom instructions that define organizational mail flow and how the email was routed."
				},
				{
					"name": "DetectionMethods",
					"type": "String",
					"description": "Delivery action of the email: Delivered, Junked, Blocked, or Replaced."
				},
				{
					"name": "DeliveryAction",
					"type": "String",
					"description": "Action of the delivered email."
				},
				{
					"name": "DeliveryLocation",
					"type": "String",
					"description": "Location of the delivered email: Inbox/Folder, On-premises/External, Junk, Quarantine, Failed, Dropped, Deleted items."
				},
				{
					"name": "EmailClusterId",
					"type": "BigInt",
					"description": "Identifier of the email cluster. Emails are clustered (grouped) based on heuristic analysis of their contents."
				},
				{
					"name": "EmailDirection",
					"type": "String",
					"description": "Email direction: Inbound, Outbound, Intra-org."
				},
				{
					"name": "EmailLanguage",
					"type": "String",
					"description": "Detected language of the email content."
				},
				{
					"name": "EmailAction",
					"type": "String",
					"description": "Final action taken on the email based on filter verdict, policies, and user actions: Move message to junk mail folder, Add X-header, Modify subject, Redirect message, Delete message, send to quarantine, No action taken, Bcc message."
				},
				{
					"name": "EmailActionPolicy",
					"type": "String",
					"description": "Action policy that took effect: Antispam high-confidence, Antispam, Antispam bulk mail, Antispam phishing, Anti-phishing domain impersonation, Anti-phishing user impersonation, Anti-phishing spoof, Anti-phishing graph impersonation, Antimalware Safe Attachments, Enterprise Transport Rules (ETR)."
				},
				{
					"name": "EmailActionPolicyGuid",
					"type": "String",
					"description": "Unique identifier of the policy that took effect."
				},
				{
					"name": "OrgLevelAction",
					"type": "String",
					"description": "Action taken on the email in response to matches to a policy defined at the organizational level."
				},
				{
					"name": "OrgLevelPolicy",
					"type": "String",
					"description": "Organizational policy that triggered the action taken on the email."
				},
				{
					"name": "InternetMessageId",
					"type": "String",
					"description": "Public-facing identifier for the email that is set by the sending email system."
				},
				{
					"name": "NetworkMessageId",
					"type": "String",
					"description": "Unique identifier for the email, generated by Office 365.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "RecipientEmailAddress",
					"type": "String",
					"description": "Recipient email address or email address of the recipient after distribution list expansion."
				},
				{
					"name": "RecipientObjectId",
					"type": "String",
					"description": "Email recipient Azure AD identifier.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ReportId",
					"type": "String",
					"description": "Unique identifier for the event."
				},
				{
					"name": "SenderDisplayName",
					"type": "String",
					"description": "Sender email address in the from header, which is visible to email recipients on their email clients."
				},
				{
					"name": "SenderFromAddress",
					"type": "String",
					"description": "Sender domain in the from header, which is visible to email recipients on their email clients."
				},
				{
					"name": "SenderFromDomain",
					"type": "String",
					"description": "Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats."
				},
				{
					"name": "SenderObjectId",
					"type": "String",
					"description": "Sender email address in the from header, which is visible to email recipients on their email clients.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "SenderIPv4",
					"type": "String",
					"description": "IPv4 address of the last detected mail server that relayed the message.",
					"dataTypeHint": "IP"
				},
				{
					"name": "SenderIPv6",
					"type": "String",
					"description": "IPv6 address of the last detected mail server that relayed the message.",
					"dataTypeHint": "IP"
				},
				{
					"name": "SenderMailFromAddress",
					"type": "String",
					"description": "Sender email address in the MAIL from header, also known as the envelope sender or the Return-Path address."
				},
				{
					"name": "SenderMailFromDomain",
					"type": "String",
					"description": "Sender domain in the MAIL from header, also known as the envelope sender or the Return-Path address."
				},
				{
					"name": "Subject",
					"type": "String",
					"description": "Email subject field."
				},
				{
					"name": "ThreatTypes",
					"type": "String",
					"description": "Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats."
				},
				{
					"name": "ThreatNames",
					"type": "String",
					"description": "Sender email address in the from header, which is visible to email recipients on their email clients."
				},
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated.",
					"isDefaultDisplay": true
				},
				{
					"name": "Timestamp",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated.",
					"isHidden": true,
					"isDefaultDisplay": false
				},
				{
					"name": "UrlCount",
					"type": "Int",
					"description": "Number of embedded URLs in the email."
				},
				{
					"name": "UserLevelAction",
					"type": "String",
					"description": "Action taken on the email in response to matches to a mailbox policy defined by the recipient."
				},
				{
					"name": "UserLevelPolicy",
					"type": "String",
					"description": "End user mailbox policy that triggered the action taken on the email."
				},
				{
					"name": "BulkComplaintLevel",
					"type": "Int",
					"description": "Threshold assigned to email from bulk mailers, a high bulk complaint level (BCL) means the email is more likely to generate complaints, and thus more likely to be spam."
				},
				{
					"name": "LatestDeliveryLocation",
					"type": "String",
					"description": "Last known location of the email."
				},
				{
					"name": "LatestDeliveryAction",
					"type": "String",
					"description": "Last known action attempted on an email by the service or by an admin through manual remediation."
				},
				{
					"name": "ExchangeTransportRule",
					"type": "String",
					"description": "Mail flow rules (also known as transport rules) are similar to Inbox rules that are available in Outlook and Outlook on the web. The main difference is mail flow rules take action on messages while they're in transit."
				},
				{
					"name": "DistributionList",
					"type": "String",
					"description": "Name of distribution list that the recipient was a member of and to which the email was sent, if applicable; shows top-level distribution list if nested lists are involved"
				},
				{
					"name": "ForwardingInformation",
					"type": "String",
					"description": "A JSON array of forwarding details including the forwarding user and the forwarding type"
				},
				{
					"name": "Context",
					"type": "String",
					"description": "Configuration context data of the machine"
				},
				{
					"name": "To",
					"type": "Dynamic",
					"description": "Indicates the addresses which are listed in To fields of an email"
				},
				{
					"name": "Cc",
					"type": "Dynamic",
					"description": "Indicates the addresses which are listed in Cc fields of an email"
				},
				{
					"name": "ThreatClassification",
					"type": "String",
					"description": "Indicates the threat classification of the mail"
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/EmailEventsSample.json",
			"sampleOutputRecordsFilePath": "SampleOutputRecords/EmailEventsSample.json"
		},
		{
			"name": "EmailPostDeliveryEvents",
			"description": "Office 365 security events occurred post email delivery to recipient mailbox.",
			"categories": [
				"security"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 11,
			"dataTypeId": "TENANTMICROSOFTWINDOWSDEFENDERATP_ADVANCEDHUNTINGEMAILPOSTDELIVERYEVENTS",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"tableState": "Production",
			"isTroubleshootingAllowed": true,
			"isLakeAllowed": true,
			"input": [
				{
					"name": "time",
					"type": "DateTime"
				},
				{
					"name": "tenantId",
					"type": "String"
				},
				{
					"name": "operationName",
					"type": "String"
				},
				{
					"name": "category",
					"type": "String"
				},
				{
					"name": "properties",
					"type": "String"
				}
			],
			"transformFilePath": "KQL/EmailPostDeliveryEventsTransform.kql",
			"columns": [
				{
					"name": "Action",
					"type": "String",
					"description": "Action taken on the entity"
				},
				{
					"name": "ActionResult",
					"type": "String",
					"description": "Result of the action"
				},
				{
					"name": "ActionTrigger",
					"type": "String",
					"description": "Indicates whether an action was triggered by an administrator (manually or through approval of a pending automated action), or by some special mechanism, such as a ZAP or String Delivery"
				},
				{
					"name": "ActionType",
					"type": "String",
					"description": "Type of activity that triggered the event"
				},
				{
					"name": "DeliveryLocation",
					"type": "String",
					"description": "Delivered email location: Inbox/Folder, On-premises/External, Junk, Quarantine, Failed, Dropped, Deleted items"
				},
				{
					"name": "InternetMessageId",
					"type": "String",
					"description": "Public-facing identifier for the email that is set by the sending email system"
				},
				{
					"name": "NetworkMessageId",
					"type": "String",
					"description": "Email unique identifier generated by Office 365",
					"dataTypeHint": "GUID"
				},
				{
					"name": "RecipientEmailAddress",
					"type": "String",
					"description": "Recipient email address or email address of the recipient after distribution list expansion"
				},
				{
					"name": "ReportId",
					"type": "String",
					"description": "Unique identifier for the event"
				},
				{
					"name": "ThreatTypes",
					"type": "String",
					"description": "Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats"
				},
				{
					"name": "DetectionMethods",
					"type": "String",
					"description": "Methods used to detect malware, phishing, or other threats found in the email"
				},
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated",
					"isDefaultDisplay": true
				},
				{
					"name": "Timestamp",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated",
					"isHidden": true,
					"isDefaultDisplay": false
				},
				{
					"name": "SenderFromAddress",
					"type": "String",
					"description": "Sender email address in the FROM header, which is visible to email recipients on their email clients"
				},
				{
					"name": "EmailDirection",
					"type": "String",
					"description": "Direction of the email relative to your network:  Inbound, Outbound, Intra-org"
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/EmailPostDeliveryEventsSample.json"
		},
		{
			"name": "EmailUrlInfo",
			"description": "Office 365 emails URLs information.",
			"categories": [
				"security"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 8,
			"dataTypeId": "TENANTMICROSOFTWINDOWSDEFENDERATP_ADVANCEDHUNTINGEMAILURLINFO",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"tableState": "Production",
      "isTroubleshootingAllowed": true,
      "isLakeAllowed": true,
			"input": [
				{
					"name": "time",
					"type": "DateTime"
				},
				{
					"name": "tenantId",
					"type": "String"
				},
				{
					"name": "operationName",
					"type": "String"
				},
				{
					"name": "category",
					"type": "String"
				},
				{
					"name": "properties",
					"type": "String"
				}
			],
			"transformFilePath": "KQL/EmailUrlInfoTransform.kql",
			"columns": [
				{
					"name": "NetworkMessageId",
					"type": "String",
					"description": "Email unique identifier generated by Office 365",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ReportId",
					"type": "String",
					"description": "Unique identifier for the event"
				},
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated",
					"isDefaultDisplay": true
				},
				{
					"name": "Timestamp",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated",
					"isHidden": true,
					"isDefaultDisplay": false
				},
				{
					"name": "Url",
					"type": "String",
					"description": "Information about URLs on Office 365 emails",
					"dataTypeHint": "URI"
				},
				{
					"name": "UrlLocation",
					"type": "String",
					"description": "Indicates which part of the email the URL is located"
				},
				{
					"name": "UrlDomain",
					"type": "String",
					"description": "Domain part of the Url"
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/EmailUrlInfoSample.json"
		},
		{
			"name": "UrlClickEvents",
			"description": "Events involving URLs clicked, selected, or requested on Microsoft Defender for Office 365.",
			"categories": [
				"security"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 5,
			"dataTypeId": "TENANTMICROSOFTWINDOWSDEFENDERATP_ADVANCEDHUNTINGURLCLICKEVENTS",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"tableState": "Production",
			"isTroubleshootingAllowed": true,
			"isLakeAllowed": true,
			"input": [
				{
					"name": "time",
					"type": "DateTime"
				},
				{
					"name": "tenantId",
					"type": "String"
				},
				{
					"name": "operationName",
					"type": "String"
				},
				{
					"name": "category",
					"type": "String"
				},
				{
					"name": "properties",
					"type": "String"
				}
			],
			"transformFilePath": "KQL/UrlClickEventsTransform.kql",
			"columns": [
				{
					"name": "Timestamp",
					"type": "DateTime",
					"description": "The date and time when the user clicked on the link.",
					"isHidden": true,
					"isDefaultDisplay": false
				},
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "The date and time when the user clicked on the link. The value is identical to TimeGenerated and intended for Microsoft Defender for Endpoints queries compatibility.",
					"isDefaultDisplay": true
				},
				{
					"name": "Url",
					"type": "String",
					"description": "The full URL that was clicked on by the user.",
					"dataTypeHint": "URI"
				},
				{
					"name": "ActionType",
					"type": "String",
					"description": "Indicates whether the click was allowed or blocked by 'safe links' or blocked due to a tenant policy e.g., from tenant allow block list."
				},
				{
					"name": "AccountUpn",
					"type": "String",
					"description": "User Principal Name of the account that clicked on the link."
				},
				{
					"name": "Workload",
					"type": "String",
					"description": "The application from which the user clicked on the link, with the values being Email, Office and Teams."
				},
				{
					"name": "NetworkMessageId",
					"type": "String",
					"description": "The unique identifier for the email that contains the clicked link, generated by Microsoft 365.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "IPAddress",
					"type": "String",
					"description": "Public IP address of the device from which the user clicked on the link.",
					"dataTypeHint": "IP"
				},
				{
					"name": "ThreatTypes",
					"type": "String",
					"description": "Verdict at the time of click, which tells whether the URL led to malware, phish or other threats."
				},
				{
					"name": "DetectionMethods",
					"type": "String",
					"description": "Detection technology which was used to identify the threat at the time of click."
				},
				{
					"name": "IsClickedThrough",
					"type": "Bool",
					"description": "Indicates whether the user was able to click through to the original URL or was not allowed."
				},
				{
					"name": "UrlChain",
					"type": "String",
					"description": "For scenarios involving redirections, it includes URLs present in the redirection chain."
				},
				{
					"name": "ReportId",
					"type": "String",
					"description": "This is the unique identifier for a click event. Note that for clickthrough scenarios, report ID would have same value, and therefore it should be used to correlate a click event.",
					"dataTypeHint": "GUID"
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/UrlClickEventsSample.json",
			"sampleOutputRecordsFilePath": "SampleOutputRecords/UrlClickEventsSample.json"
		},
		{
			"name": "FileMaliciousContentInfo",
			"description": "This table shows files that were identified as malicious by Microsoft Defender for Office 365 in SharePoint Online, OneDrive for Business, and Microsoft Teams.",
			"categories": [
				"security"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 3,
			"dataTypeId": "TENANTMICROSOFTWINDOWSDEFENDERATP_ADVANCEDHUNTINGFILEMALICIOUSCONTENTINFO",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"tableState": "Production",
      "isTroubleshootingAllowed": true,
      "isLakeAllowed": true,
			"input": [
				{
					"name": "time",
					"type": "DateTime"
				},
				{
					"name": "tenantId",
					"type": "String"
				},
				{
					"name": "operationName",
					"type": "String"
				},
				{
					"name": "category",
					"type": "String"
				},
				{
					"name": "properties",
					"type": "Dynamic"
				}
			],
			"transformFilePath": "KQL/FileMaliciousContentInfoTransform.kql",
			"columns": [
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated.",
					"isDefaultDisplay": true
				},
				{
					"name": "Timestamp",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated. This is identical to TimeGenerated and added for query portability from MDO Advanced Hunting.",
					"isHidden": true,
					"isDefaultDisplay": false
				},
				{
					"name": "Workload",
					"type": "String",
					"description": "Information about the workload from which the URL originated from."
				},
				{
					"name": "FileName",
					"type": "String",
					"description": "Name of the file that the recorded action was applied to."
				},
				{
					"name": "FolderPath",
					"type": "String",
					"description": "Folder containing the file that the recorded action was applied to."
				},
				{
					"name": "FileSize",
					"type": "BigInt",
					"description": "Size of the file in bytes."
				},
				{
					"name": "SHA256",
					"type": "String",
					"description": "SHA-256 of the file that the recorded action was applied to."
				},
				{
					"name": "FileOwnerDisplayName",
					"type": "String",
					"description": "Account recorded as owner of the file."
				},
				{
					"name": "FileOwnerUpn",
					"type": "String",
					"description": "Account recorded as owner of the file"
				},
				{
					"name": "LastModifyingAccountUpn",
					"type": "String",
					"description": "Account that last modified this file."
				},
				{
					"name": "DocumentID",
					"type": "String",
					"description": "Unique identifier of the file.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "ThreatTypes",
					"type": "String",
					"description": "Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats."
				},
				{
					"name": "ThreatNames",
					"type": "String",
					"description": "Detection name for malware or other threats found."
				},
				{
					"name": "DetectionMethods",
					"type": "String",
					"description": "Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats."
				},
				{
					"name": "LastModifiedTime",
					"type": "DateTime",
					"description": "Date and time the item, or related metadata was last modified."
				},
				{
					"name": "FileCreationTime",
					"type": "DateTime",
					"description": "Timestamp of the file creation."
				},
				{
					"name": "ReportId",
					"type": "String",
					"description": "Unique identifier for the event.",
					"dataTypeHint": "GUID"
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/FileMaliciousContentInfoSample.json",
			"sampleOutputRecordsFilePath": "SampleOutputRecords/FileMaliciousContentInfoSample.json"
		},
		{
			"name": "CampaignInfo",
			"description": "This table shows information about campaigns identified by Microsoft Defender for Office 365.",
			"categories": [
				"security"
			],
			"tags": {},
			"properties": {},
			"artifactVersion": 3,
			"dataTypeId": "TENANTMICROSOFTWINDOWSDEFENDERATP_ADVANCEDHUNTINGCAMPAIGNINFO",
			"intelligencePacks": [
				"SecurityInsights"
			],
			"isResourceCentric": false,
			"tableState": "Production",
      "isTroubleshootingAllowed": true,
      "isLakeAllowed": true,
			"input": [
				{
					"name": "time",
					"type": "DateTime"
				},
				{
					"name": "tenantId",
					"type": "String"
				},
				{
					"name": "operationName",
					"type": "String"
				},
				{
					"name": "category",
					"type": "String"
				},
				{
					"name": "properties",
					"type": "Dynamic"
				}
			],
			"transformFilePath": "KQL/CampaignInfoTransform.kql",
			"columns": [
				{
					"name": "TimeGenerated",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated.",
					"isDefaultDisplay": true
				},
				{
					"name": "Timestamp",
					"type": "DateTime",
					"description": "Date and time (UTC) when the record was generated.",
					"isHidden": true,
					"isDefaultDisplay": false
				},
				{
					"name": "CampaignName",
					"type": "String",
					"description": "Name of the email campaign."
				},
				{
					"name": "CampaignId",
					"type": "String",
					"description": "Unique identifier for the campaign, generated by Office 365.",
					"dataTypeHint": "GUID"
				},
				{
					"name": "CampaignType",
					"type": "String",
					"description": "Category of the campaign."
				},
				{
					"name": "CampaignSubType",
					"type": "String",
					"description": "Contains more details about the campaign, like the brand being phished, or related malware campaigns, if available."
				},
				{
					"name": "NetworkMessageId",
					"type": "String",
					"description": "Unique identifier for the email, generated by Office 365."
				},
				{
					"name": "RecipientEmailAddress",
					"type": "String",
					"description": "Email address of the recipient, or email address of the recipient after distribution list expansion."
				},
				{
					"name": "ReportId",
					"type": "String",
					"description": "Unique identifier for the event.",
					"dataTypeHint": "GUID"
				}
			],
			"sampleInputRecordsFilePath": "SampleInputRecords/CampaignInfoSample.json"
		}
	],
	"functions": [],
	"queries": [
		{
			"id": "44fc0e47-dc0e-4d77-8fcb-0e7aa58b7e92",
			"displayName": "Phishing emails from the top 10 sender domains",
			"description": "Get the number of phishing emails from the top ten sender domains.",
			"bodyFilePath": "KQL/TopTenSendersOfPhishingEmailsQuery.kql",
			"categories": [
				"security"
			],
			"relatedTables": [
				"EmailEvents"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "824be1eb-27b7-44e9-97b6-ceba952b5301",
			"displayName": "Emails with malware",
			"description": "Get the number of phishing emails from the top ten sender domains.",
			"bodyFilePath": "KQL/EmailsWithMalwareQuery.kql",
			"categories": [
				"security"
			],
			"relatedTables": [
				"EmailEvents"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "90f66bc3-2a34-4ea7-8849-2a0c1abb9a75",
			"displayName": "Files from malicious sender",
			"description": "Finds the first appearance of files sent by a malicious sender in your organization at selected time frame. To see earlier appearances please increase selected time range.",
			"bodyFilePath": "KQL/FilesFromMaliciousSenderQuery.kql",
			"categories": [
				"security"
			],
			"relatedTables": [
				"EmailAttachmentInfo"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "d826f137-f675-459e-a758-5acbc604ce90",
			"displayName": "Emails to external domains with attachments",
			"description": "Emails sent to an external domain that include attachments.",
			"bodyFilePath": "KQL/ToExternalWithAttachmentQuery.kql",
			"categories": [
				"security"
			],
			"relatedTables": [
				"EmailAttachmentInfo"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},	
		{
			"id": "d353de41-be6b-4bd0-9c88-62f8db108f09",
			"displayName": "URLs in an email",
			"description": "URLs in a particular message, by NetworkMessageId identifier.",
			"bodyFilePath": "KQL/UrlsInEmailsQuery.kql",
			"categories": [
				"security"
			],
			"relatedTables": [
				"EmailUrlInfo"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "4759e733-d0b0-4415-bd31-72b9765994d6",
			"displayName": "Post-delivery administrator actions",
			"description": "Display post-delivery actions made by Administrator.",
			"bodyFilePath": "KQL/PostDeliveryAdministratorActionsQuery.kql",
			"categories": [
				"security"
			],
			"relatedTables": [
				"EmailPostDeliveryEvents"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "a2cdbdc7-3abb-426d-a77f-771d6bf5a4f9",
			"displayName": "Unremediated post-delivery phishing email detections",
			"description": "Display post-delivery phishing email detections which was not remediated.",
			"bodyFilePath": "KQL/PostDeliveryPhishingEmailDetectionsQuery.kql",
			"categories": [
				"security"
			],
			"relatedTables": [
				"EmailPostDeliveryEvents"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "fb42f174-b844-4416-8033-9f40cd9162a4",
			"displayName": "Full email processing details",
			"description": "Emails that include predefined post-delivery actions or automatic rules, by sender and subject.",
			"bodyFilePath": "KQL/FullEmailProcessingDetailsQuery.kql",
			"categories": [
				"security"
			],
			"relatedTables": [
				"EmailPostDeliveryEvents"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		},
		{
			"id": "11769810-ba17-4663-bdc3-d6114617aadd",
			"displayName": "Links where a user was allowed to proceed",
			"description": "Malicious links where user was allowed to proceed through.",
			"bodyFilePath": "KQL/UrlClickEventsSampleQuery.kql",
			"categories": [
				"security"
			],
			"relatedTables": [
				"UrlClickEvents"
			],
			"tags": {
				"Topic": [
					"Security"
				]
			},
			"properties": {
				"ExampleQuery": true,
				"QueryAttributes": {
					"IsMultiResource": false
				}
			}
		}
	]
}