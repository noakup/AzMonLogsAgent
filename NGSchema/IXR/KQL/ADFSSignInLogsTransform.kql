source
| project
    TenantId = tenantId,
    SourceSystem = "Azure AD",
    TimeGenerated = todatetime(["time"]),
    OperationName = operationName,
    OperationVersion = operationVersion,
    Category = category,
    ResultType = resultType,
    ResultSignature = resultSignature,
    ResultDescription = resultDescription,
    DurationMs = tolong(durationMs),
    CorrelationId = correlationId,
    ResourceGroup = tostring(split(resourceId, '/')[4]),
    Identity = identity,
    Level = Level,
    Location = location,
    AlternateSignInName = tostring(properties.alternateSignInName),
    AppDisplayName = tostring(properties.appDisplayName),
    AppId = tostring(properties.appId),
    AuthenticationDetails = tostring(properties.authenticationDetails),
    AuthenticationProcessingDetails = tostring(properties.authenticationProcessingDetails),
    AuthenticationRequirement = tostring(properties.authenticationRequirement),
    AuthenticationRequirementPolicies = tostring(properties.authenticationRequirementPolicies),
    ConditionalAccessPolicies = tostring(properties.appliedConditionalAccessPolicies),
    ConditionalAccessPoliciesV2 = todynamic(""),
    ConditionalAccessStatus = tostring(properties.conditionalAccessStatus),
    CreatedDateTime = todatetime(properties.createdDateTime),
    DeviceDetail = tostring(properties.deviceDetail),
    IsInteractive = tobool(properties.isInteractive),
    Id = tostring(properties.id),
    IPAddress = tostring(properties.ipAddress),
    NetworkLocationDetails = tostring(properties.networkLocationDetails),
    OriginalRequestId = tostring(properties.originalRequestId),
    ProcessingTimeInMs = tostring(properties.processingTimeInMilliseconds),
    ResourceIdentity = tostring(properties.resourceId),
    ResourceDisplayName = tostring(properties.resourceDisplayName),
    ResourceTenantId = tostring(properties.resourceTenantId),
    Requirement = tostring(properties.authenticationDetails[0]["authenticationStepRequirement"]),
    Status = tostring(properties.status),
    TokenIssuerName = tostring(properties.tokenIssuerName),
    TokenIssuerType = tostring(properties.tokenIssuerType),
    UniqueTokenIdentifier = tostring(properties.uniqueTokenIdentifier),
    UserAgent = tostring(properties.userAgent),
    UserDisplayName = tostring(properties.userDisplayName),
    UserId = tostring(properties.userId),
    UserPrincipalName = tostring(properties.userPrincipalName)