source  
| extend properties = parse_json(properties)
| extend resourceIdArray = split(resourceId, "/") 
| extend numElementsInResourceId = array_length(resourceIdArray) 
| extend accountNameExtracted = resourceIdArray[numElementsInResourceId - 1] 
| project 
	TimeGenerated = todatetime(['time']),    
	AccountName = tostring(accountNameExtracted), 
	OperationName = operationName, 
	ConnectionMode = tostring(properties.connectionMode), 
	UserAgent = tostring(properties.userAgent), 
	RequestResourceType = tostring(properties.requestResourceType), 
	RequestResourceId = tostring(properties.requestResourceId),
	StatusCode = toint(properties.statusCode), 
	ClientIpAddress = tostring(properties.clientIpAddress), 
	TotalRequestCharge = todouble(properties.requestChargeSum), 
	AvgRequestCharge = todouble(properties.requestChargeAvg), 
	MaxRequestCharge = todouble(properties.requestChargeMax), 
	TotalDurationMs = todouble(properties.durationSum), 
	AvgDurationMs = todouble(properties.durationAvg), 
	MaxDurationMs = todouble(properties.durationMax), 
	TotalRequestLength = todouble(properties.requestLengthSum), 
	AvgRequestLength = todouble(properties.requestLengthAvg), 
	MaxRequestLength = todouble(properties.requestLengthMax), 
	TotalResponseLength = todouble(properties.responseLengthSum),
	AvgResponseLength = todouble(properties.responseLengthAvg),
	MaxResponseLength = todouble(properties.responseLengthMax), 
	RequestCount = todouble(properties.sampleCount), 
	RegionName = tostring(properties.region), 
	PartitionId = tostring(properties.partitionId), 
	AadAppliedRoleAssignmentId = tostring(properties.aadAppliedRoleAssignmentId), 
	AadPrincipalId = tostring(properties.aadPrincipalId), 
	DatabaseName = tostring(properties.databaseName), 
	CollectionName = tostring(properties.collectionName), 
	ResourceTokenPermissionId = tostring(properties.resourceTokenPermissionId), 
	ResourceTokenPermissionMode = tostring(properties.resourceTokenPermissionMode), 
	ResourceTokenUserRid = tostring(properties.resourceTokenUserRid), 
	KeyType = tostring(properties.keyType), 
	AuthTokenType = tostring(properties.authTokenType)