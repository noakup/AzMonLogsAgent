source
| extend properties = parse_json(properties)
| project 
    TimeGenerated = todatetime(["time"]),
    TimeRequested = todatetime(properties.timeGenerated),
    Location = location,
    RequestId = tostring(properties.requestId),
    ApiVersion = tostring(properties.apiVersion),
    AADTenantId = tostring(properties.tenantId),
    OperationName = operationName,
    Category = category,
    ResultSignature = tostring(resultSignature),
    DurationMs = toint(properties.durationMs),
    Level = level,
    RequestMethod = tostring(properties.httpMethod),
    ResponseStatusCode = toint(properties.httpStatusCode),
    ResponseSizeBytes = toint(properties.responseSizeBytes),
    SignInActivityId = tostring(properties.signInActivityId),
    Roles = tostring(properties.roles),
    TokenIssuedAt = todatetime(properties.issuedAt),
    AppId = tostring(properties.appId),
    UserId = tostring(properties.userId),
    ServicePrincipalId = tostring(properties.servicePrincipalId),
    Scopes = tostring(properties.scopes),
    IdentityProvider = tostring(properties.identityProvider),
    ClientAuthMethod = tostring(properties.clientAuthMethod),
    Wids = tostring(properties.wids),
    CallerIpAddress = tostring(properties.callerIpAddress),
    UserAgent = tostring(properties.userAgent),
    RequestUri = tostring(properties.requestUri),
    SessionId = tostring(properties.sessionId),
    DeviceId = tostring(properties.deviceId),
    ActorType = tostring(properties.actorType)