{
    "type": "Microsoft.AzureSphere/catalogs",
    "displayName": "Azure Sphere",
    "description": "All tables related to the Azure Sphere Service.",
    "tags": {},
    "properties": {},
    "simplifiedSchemaVersion": "3",
    "icmTeam": "Azure Sphere Security Service/Triage",
    "contactDL": "sataneja@microsoft.com",
    "relatedTables": [],
    "relatedFunctions": [],
    "tables": [
        {
            "name": "ASCAuditLogs",
            "description": "Contains audit logs generated by Azure Sphere service and devices. Logs can be used for audit and troubleshooting.",
            "categories": [ "resources", "audit" ],
            "tags": {},
            "properties": {},
            "artifactVersion": 3,
            "dataTypeId": "MICROSOFTAZURESPHERE_AUDITLOGS",
            "isResourceCentric": true,
			"tableState": "Production",
            "isLakeAllowed": true,
			"isTroubleshootingAllowed": true,
            "transformFilePath": "KQL/Transforms/ASCAuditLogsTransform.kql",
            "sampleInputRecordsFilePath": "SampleInputRecords/ASCAuditLogsSample.json",
            "sampleOutputRecordsFilePath": "SampleOutputRecords/ASCAuditLogsSample.json",
            "input": [
                {
                    "name": "time",
                    "type": "DateTime"
                },
                {
                    "name": "location",
                    "type": "String"
                },
                {
                    "name": "operationName",
                    "type": "String"
                },
                {
                    "name": "category",
                    "type": "String"
                },
                {
                    "name": "resultType",
                    "type": "String"
                },
                {
                    "name": "resultDescription",
                    "type": "String"
                },
                {
                    "name": "identity",
                    "type": "Dynamic"
                },
                {
                    "name": "properties",
                    "type": "Dynamic"
                },
                {
                    "name": "correlationId",
                    "type": "String"
                },
                {
                    "name": "durationMs",
                    "type": "String"
                }
            ],
            "columns": [
                {
                    "name": "TimeGenerated",
                    "type": "DateTime",
                    "isDefaultDisplay": true,
                    "description": "Timestamp(UTC) when the log event was generated."
                },
                {
                    "name": "Location",
                    "type": "String",
                    "isDefaultDisplay": true,
                    "description": "The location and region where the log event was generated."
                },
                {
                    "name": "OperationName",
                    "type": "String",
                    "isDefaultDisplay": true,
                    "description": "The Azure Sphere operation associated with the log event."
                },                
                {
                    "name": "ResultType",
                    "type": "String",
                    "isDefaultDisplay": true,
                    "description": "The result type (success, failure) for the log event."
                },
                {
                    "name": "ResultDescription",
                    "type": "String",
                    "isDefaultDisplay": true,
                    "description": "The result description for the log event."
                },
                {
                    "name": "Identity",
                    "type": "Dynamic",
                    "isDefaultDisplay": true,
                    "description": "Identity of the user or application responsible for the log event."
                },
                {
                    "name": "Properties",
                    "type": "Dynamic",
                    "isDefaultDisplay": true,
                    "description": "Additional properties related to the log event."
                },
                {
                    "name": "CorrelationId",
                    "type": "String",
                    "dataTypeHint": "GUID",
                    "isDefaultDisplay": true,
                    "description": "A unique correlation ID for the log event."
                },
                {
                    "name": "DurationMs",
                    "type": "Int",
                    "isDefaultDisplay": true,
                    "description": "The total duration (in milliseconds) for the log event."
                }
            ]
        },
        {
            "name": "ASCDeviceEvents",
            "description": "Contains event details for operations generated by Azure Sphere devices. These logs contain information about event types, event categories, event classes, event descriptions etc. that can be used for monitoring and troubleshooting app crashes on devices.",
            "categories": [ "resources", "audit" ],
            "tags": {},
            "properties": {},
            "artifactVersion": 1,
            "dataTypeId": "MICROSOFTAZURESPHERE_DEVICEEVENTS",
            "isResourceCentric": true,
			"tableState": "Production",
			"isTroubleshootingAllowed": true,
            "transformFilePath": "KQL/Transforms/ASCDeviceEventsTransform.kql",
            "sampleInputRecordsFilePath": "SampleInputRecords/ASCDeviceEventsSample.json",
            "sampleOutputRecordsFilePath": "SampleOutputRecords/ASCDeviceEventsSample.json",
            "input": [
                {
                    "name": "time",
                    "type": "DateTime"
                },
                {
                    "name": "location",
                    "type": "String"
                },
                {
                    "name": "operationName",
                    "type": "String"
                },
                {
                    "name": "resultType",
                    "type": "String"
                },
                {
                    "name": "resultDescription",
                    "type": "String"
                },
                {
                    "name": "correlationId",
                    "type": "String"
                },
                {
                    "name": "durationMs",
                    "type": "String"
                },
                {
                    "name": "properties",
                    "type": "Dynamic"
                }
            ],
            "columns": [
                {
                    "name": "TimeGenerated",
                    "type": "DateTime",
                    "isDefaultDisplay": true,
                    "description": "Timestamp(UTC) when the log event was generated."
                },
                {
                    "name": "Location",
                    "type": "String",
                    "isDefaultDisplay": true,
                    "description": "The location and region where the log event was generated."
                },
                {
                    "name": "OperationName",
                    "type": "String",
                    "isDefaultDisplay": true,
                    "description": "The Azure Sphere operation associated with the log event."
                },
                {
                    "name": "DeviceId",
                    "type": "String",
                    "isDefaultDisplay": true,
                    "description": "The ID of the device where the log event was generated."
                },
                {
                    "name": "CatalogId",
                    "type": "String",
                    "dataTypeHint": "GUID",
                    "isDefaultDisplay": true,
                    "description": "The catalog ID of the device where the log event was generated."
                },
                {
                    "name": "Properties",
                    "type": "Dynamic",
                    "isDefaultDisplay": true,
                    "description": "Additional properties related to the log event."
                },                
                {
                    "name": "ResultType",
                    "type": "String",
                    "isDefaultDisplay": true,
                    "description": "The result type (success, failure) for the log event."
                },
                {
                    "name": "ResultDescription",
                    "type": "String",
                    "isDefaultDisplay": true,
                    "description": "The result description for the log event."
                },
                {
                    "name": "CorrelationId",
                    "type": "String",                    
                    "isDefaultDisplay": true,
                    "description": "A unique correlation ID for the log event."
                },
                {
                    "name": "DurationMs",
                    "type": "Int",
                    "isDefaultDisplay": true,
                    "description": "The total duration (in milliseconds) for the log event."
                }
            ]
        }
    ],

    "queries": [
        {
            "id": "483f4b2c-5325-441f-9ec4-edc9baefcdd4",
            "displayName": "Azure Sphere device authentication and attestation failures",
            "description": "A list of Azure Sphere device authentication and attestation failures for the last week, sorted by time.",
            "bodyFilePath": "KQL/Queries/DeviceEvents/ASCDeviceAuthAndAttestationFailures.kql",
            "categories": [ "resources" ],
            "relatedTables": [ "ASCDeviceEvents" ],
            "tags": {
                "Topic": [ "Diagnostics", "Errors", "Alerts" ]
            },
            "properties": {
              "ExampleQuery": true
            }
        },
        {
            "id": "24acfce7-569c-4e05-9145-e09752fae02c",
            "displayName": "Azure Sphere device events timeline",
            "description": "A sorted timeline of all events generated by an Azure Sphere device during the last week, to monitor and troubleshoot any unexpected failures.",
            "bodyFilePath": "KQL/Queries/DeviceEvents/ASCDeviceEventsTimeline.kql",
            "categories": [ "resources" ],
            "relatedTables": [ "ASCDeviceEvents" ],
            "tags": {
                "Topic": [ "Diagnostics", "Errors", "Alerts" ]
            },
            "properties": {
              "ExampleQuery": true
            }
        },
        {
            "id": "0c4a1b53-4761-4793-88ee-b5e569a333c4",
            "displayName": "Azure Sphere device heartbeat events timechart",
            "description": "A timechart of all certificate generation events initiated by Azure Sphere devices over the last week, to continuously monitor device health and see trends.",
            "bodyFilePath": "KQL/Queries/DeviceEvents/ASCDeviceHeartbeatTimeChart.kql",
            "categories": [ "resources" ],
            "relatedTables": [ "ASCDeviceEvents" ],
            "tags": {
                "Topic": [ "Diagnostics", "Errors", "Alerts" ]
            },
            "properties": {
              "ExampleQuery": true
            }
        },
        {
            "id": "f718df22-98e8-4b32-a6d0-bfd05f725a42",
            "displayName": "Azure Sphere devices not updated to latest OS",
            "description": "A list of Azure Sphere devices that have not been updated to the latest OS version over the last week.",
            "bodyFilePath": "KQL/Queries/DeviceEvents/ASCDevicesNotUpdatedToLatestOS.kql",
            "categories": [ "resources" ],
            "relatedTables": [ "ASCDeviceEvents" ],
            "tags": {
                "Topic": [ "Diagnostics", "Errors", "Alerts" ]
            },
            "properties": {
              "ExampleQuery": true
            }
        },
        {
            "id": "5ef6030d-8c6a-44a0-8739-5797f36eea20",
            "displayName": "Azure Sphere device telemetry events summary",
            "description": "A piechart summarizing the share of each of the event categories generated by Azure Sphere Devices over the last week, to monitor the overall device health.",
            "bodyFilePath": "KQL/Queries/DeviceEvents/ASCDeviceTelemetryEventsSummary.kql",
            "categories": [ "resources" ],
            "relatedTables": [ "ASCDeviceEvents" ],
            "tags": {
                "Topic": [ "Diagnostics", "Errors" ]
            },
            "properties": {
              "ExampleQuery": true
            }
        }
    ],

	"functions": []
}