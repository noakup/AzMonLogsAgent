Prompt,Query
calculate error rate by workload last 30m,"ContainerLogV2 | where TimeGenerated > ago(30m) | extend Labels = KubernetesMetadata.podLabels | extend WorkloadName = tostring(coalesce(Labels[""app.kubernetes.io/name""], Labels[""app""], PodName)) | extend IsError = LogLevel in~ (""CRITICAL"",""ERROR"") or LogSource==""stderr"" | summarize Errors=countif(IsError), Total=count() by WorkloadName, PodNamespace | extend ErrorRatePct = 100.0 * Errors / iff(Total==0,1,Total) | order by ErrorRatePct desc"
find latency over 750ms for payments workload in the last hour,"ContainerLogV2 | where TimeGenerated > ago(1h) | extend Labels = KubernetesMetadata.podLabels | extend WorkloadName = tostring(coalesce(Labels[""app.kubernetes.io/name""], Labels[""app""], PodName)) | where WorkloadName =~ ""payments"" | extend Plain = tostring(LogMessage) | extend LatencyMs = toint(extract(""latency[=:]\\s?([0-9]+)ms"", 1, Plain)) | where LatencyMs > 750 | project TimeGenerated, PodNamespace, PodName, ContainerName, LatencyMs, Plain"